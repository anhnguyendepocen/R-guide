<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Brendon Smith br3ndonland Source code on GitHub license" />


<title>R sample code</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}

.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R guide</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Guide</a>
</li>
<li>
  <a href="code.html">Sample code</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R sample code</h1>
<h4 class="author"><em>Brendon Smith<br><a href="https://github.com/br3ndonland">br3ndonland</a><br>Source code on <a href="https://github.com/br3ndonland/R-guide">GitHub</a><br><a href="https://choosealicense.com/"><img src="https://img.shields.io/badge/license-MIT-blue.svg?longCache=true&amp;style=for-the-badge" alt="license" /></a></em></h4>

</div>


<div id="data-structures" class="section level2">
<h2>Data structures</h2>
<div id="data-frame" class="section level3">
<h3>Data frame</h3>
<div id="example-from-cookbook-for-r" class="section level4">
<h4>Example from <a href="http://www.cookbook-r.com/Manipulating_data/Reordering_the_columns_in_a_data_frame/">Cookbook for R</a></h4>
<div id="sample-data-frame" class="section level5">
<h5>Sample data frame</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">sample_data &lt;-<span class="st"> </span><span class="kw">data.frame</span> (<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">weight=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">27</span>,<span class="dv">24</span>), <span class="dt">size=</span><span class="kw">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>, <span class="st">&#39;medium&#39;</span>))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">sample_data</a></code></pre></div>
<pre><code>##   id weight   size
## 1  1     20  small
## 2  2     27  large
## 3  3     24 medium</code></pre>
</div>
<div id="sort-data-frame-by-column-number" class="section level5">
<h5>Sort data frame by column number</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">sample_data[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)]</a></code></pre></div>
<pre><code>##   id   size weight
## 1  1  small     20
## 2  2  large     27
## 3  3 medium     24</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># To actually change &#39;data&#39;, run:</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># data &lt;- data[c(1,3,2)]</span></a></code></pre></div>
</div>
<div id="sort-data-frame-by-column-name" class="section level5">
<h5>Sort data frame by column name</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">sample_data[<span class="kw">c</span>(<span class="st">&#39;size&#39;</span>, <span class="st">&#39;id&#39;</span>, <span class="st">&#39;weight&#39;</span>)]</a></code></pre></div>
<pre><code>##     size id weight
## 1  small  1     20
## 2  large  2     27
## 3 medium  3     24</code></pre>
</div>
</div>
<div id="example-from-stack-overflow" class="section level4">
<h4>Example from <a href="http://stackoverflow.com/questions/1296646/how-to-sort-a-dataframe-by-columns-in-r">Stack Overflow</a></h4>
<div id="sample-data-frame-1" class="section level5">
<h5>Sample data frame</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">dd &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">b =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Hi&#39;</span>, <span class="st">&#39;Med&#39;</span>, <span class="st">&#39;Hi&#39;</span>, <span class="st">&#39;Low&#39;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&#39;Low&#39;</span>, <span class="st">&#39;Med&#39;</span>, <span class="st">&#39;Hi&#39;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>), <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>), <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">dd</a></code></pre></div>
<pre><code>##     b x y z
## 1  Hi A 8 1
## 2 Med D 3 1
## 3  Hi A 9 1
## 4 Low C 9 2</code></pre>
</div>
<div id="sort-data-frame-by-column" class="section level5">
<h5>Sort data frame by column</h5>
<p>Sorting the frame by column z (descending) then by column b(ascending)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">dd[<span class="kw">with</span>(dd, <span class="kw">order</span>(<span class="op">-</span>z, b)), ]</a></code></pre></div>
<pre><code>##     b x y z
## 4 Low C 9 2
## 2 Med D 3 1
## 1  Hi A 8 1
## 3  Hi A 9 1</code></pre>
</div>
<div id="sort-data-frame-by-column-index" class="section level5">
<h5>Sort data frame by column index</h5>
<blockquote>
<p>Edit some 2+ years later: It was just asked how to do this by column index. The answer is to simply pass the desired sorting column(s) to the order() function rather than using the name of the column (and with() for easier/more direct access).</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">dd[ <span class="kw">order</span>(<span class="op">-</span>dd[,<span class="dv">4</span>], dd[,<span class="dv">1</span>]), ]</a></code></pre></div>
<pre><code>##     b x y z
## 4 Low C 9 2
## 2 Med D 3 1
## 1  Hi A 8 1
## 3  Hi A 9 1</code></pre>
</div>
</div>
</div>
</div>
<div id="statistical-models" class="section level2">
<h2>Statistical models</h2>
<div id="t-test" class="section level3">
<h3>T-test</h3>
<div id="atheroma-thickness" class="section level4">
<h4>Atheroma thickness</h4>
<p>Atheroma thickness data from Smith BW J Food Res 2013 (doi: <a href="https://dx.doi.org/10.5539%2Fjfr.v2n1p168">10.5539/jfr.v2n1p168</a>).</p>
<div id="import-dataset" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">jfr2013_atheroma &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/t_test_jfr2013_atheroma.csv&#39;</span>,</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">                               <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                               )</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">attach</span>(jfr2013_atheroma)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="kw">names</span>(jfr2013_atheroma)</a></code></pre></div>
<pre><code>## [1] &quot;diet&quot;      &quot;thickness&quot;</code></pre>
</div>
<div id="perform-t-test" class="section level5">
<h5>Perform t-test</h5>
<ul>
<li>The default assumes unequal variance and applies the Satterthwaite/Welch df modification.</li>
<li>var.equal = TRUE is used to specify equal variances and a pooled variance estimate.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">t.test</span>(jfr2013_atheroma<span class="op">$</span>thickness<span class="op">~</span>jfr2013_atheroma<span class="op">$</span>diet,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">       <span class="dt">paired=</span><span class="ot">FALSE</span>, <span class="dt">alternative=</span><span class="st">&#39;two.sided&#39;</span>, <span class="dt">var.equal=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">       <span class="dt">conf.level=</span><span class="fl">0.95</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">       ) </a></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  jfr2013_atheroma$thickness by jfr2013_atheroma$diet
## t = 1.4364, df = 15, p-value = 0.1714
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -43.34361 222.51028
## sample estimates:
## mean in group 0.1 mean in group 0.4 
##          356.2500          266.6667</code></pre>
</div>
<div id="test-assumptions" class="section level5">
<h5>Test assumptions</h5>
<p>The t test uses raw data, not residuals, so assumptions are tested using raw data.</p>
<div id="normality" class="section level6">
<h6>Normality</h6>
<ul>
<li>The RColorBrewer package is loaded for additional colors, and a palette is added to R. Use brackets after vector name for specific colors when creating plots (for example: <code>col=set1[4:14]</code>).</li>
<li>Legend can also be manually positioned with xy coordinates (numbers from 0,0 at bottom left of whole plot to 1,1 at top right)</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Shapiro-Wilk W test</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">shapiro.test</span>(thickness)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  thickness
## W = 0.91231, p-value = 0.1094</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># Normal Quantile-Quantile Plot</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co"># Set graphical parameters</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="dv">3</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb20-4" data-line-number="4">    <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">lend =</span> <span class="dv">0</span>, <span class="dt">ljoin =</span> <span class="dv">0</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, </a>
<a class="sourceLine" id="cb20-5" data-line-number="5">    <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">    )</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co"># Load RColorBrewer and set palette</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">set1 &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Set1&#39;</span>)</a>
<a class="sourceLine" id="cb20-11" data-line-number="11"></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co"># Create vector for categories</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">categories &lt;-<span class="st"> </span><span class="kw">factor</span>(jfr2013_atheroma<span class="op">$</span>diet)</a>
<a class="sourceLine" id="cb20-14" data-line-number="14"></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co"># Create plot</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="kw">qqnorm</span>(jfr2013_atheroma<span class="op">$</span>thickness, </a>
<a class="sourceLine" id="cb20-17" data-line-number="17">       <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">bold</span>(<span class="kw">paste</span>(<span class="st">&#39;Thickness, &#39;</span>,mu, <span class="st">&#39;m&#39;</span>))), </a>
<a class="sourceLine" id="cb20-18" data-line-number="18">       <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col=</span>set1[categories], <span class="dt">lwd=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19">       )</a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co"># Add normal line</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="kw">qqline</span>(jfr2013_atheroma<span class="op">$</span>thickness, <span class="dt">lwd=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co"># Add border to complete axes</span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="kw">box</span>(<span class="dt">which =</span> <span class="st">&#39;plot&#39;</span>, <span class="dt">bty =</span> <span class="st">&#39;o&#39;</span>, <span class="dt">lwd=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>) <span class="co"># x axis</span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>) <span class="co"># y axis</span></a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="co"># Add legend</span></a>
<a class="sourceLine" id="cb20-27" data-line-number="27"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="dt">legend=</span><span class="kw">levels</span>(categories), </a>
<a class="sourceLine" id="cb20-28" data-line-number="28">       <span class="dt">box.lwd=</span><span class="dv">3</span>, <span class="dt">pch=</span><span class="fl">1.5</span>, <span class="dt">cex=</span><span class="fl">1.75</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>, <span class="dt">pt.lwd=</span><span class="dv">4</span>, <span class="dt">col=</span>set1</a>
<a class="sourceLine" id="cb20-29" data-line-number="29">       )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="equality-of-variances" class="section level6">
<h6>Equality of variances</h6>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">var.test</span>(jfr2013_atheroma<span class="op">$</span>thickness<span class="op">~</span>jfr2013_atheroma<span class="op">$</span>diet)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  jfr2013_atheroma$thickness by jfr2013_atheroma$diet
## F = 1.8725, num df = 7, denom df = 8, p-value = 0.3983
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.4134808 9.1738855
## sample estimates:
## ratio of variances 
##           1.872473</code></pre>
</div>
</div>
<div id="boxplot" class="section level5">
<h5>Boxplot</h5>
<ul>
<li><strong>Parameters (<code>par</code>):</strong> Graphical parameters need to be set again because of code chunk separation in RMarkdown. Normally they would only be set once per R session.</li>
<li><strong>X axis:</strong> The default axes will usually detect categorical data and label axes accordingly, but categories will need to be specified for axes created separately. It is easiest to create a separate vector with the categories, and then reference it when creating the plot. Labels can also be specified with <code>labels=c('group1', 'group2')</code>.</li>
<li><strong>Y axis:</strong> Note that it does not always start at zero, but encompasses the data range with some padding.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># Set graphical parameters</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="dv">3</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb23-3" data-line-number="3">    <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">lend =</span> <span class="dv">0</span>, <span class="dt">ljoin =</span> <span class="dv">0</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, </a>
<a class="sourceLine" id="cb23-4" data-line-number="4">    <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">    )</a>
<a class="sourceLine" id="cb23-6" data-line-number="6"></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co"># Create boxplot</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="kw">boxplot</span>(jfr2013_atheroma<span class="op">$</span>thickness<span class="op">~</span>jfr2013_atheroma<span class="op">$</span>diet,</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">        <span class="dt">main=</span><span class="st">&#39;Atheroma Thickness&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Diet&#39;</span>,</a>
<a class="sourceLine" id="cb23-10" data-line-number="10">        <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">bold</span>(<span class="kw">paste</span>(<span class="st">&#39;Thickness, &#39;</span>,mu, <span class="st">&#39;m&#39;</span>))), </a>
<a class="sourceLine" id="cb23-11" data-line-number="11">        <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">lwd=</span><span class="dv">4</span>, <span class="dt">medlwd=</span><span class="dv">7</span>, <span class="dt">outlwd=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">col=</span>set1</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">        )</a>
<a class="sourceLine" id="cb23-13" data-line-number="13"></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co"># Add border to complete axes</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="kw">box</span>(<span class="dt">which =</span> <span class="st">&#39;plot&#39;</span>, <span class="dt">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">lwd =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb23-16" data-line-number="16"></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co"># Create vector with means of each group</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18">means &lt;-<span class="st"> </span><span class="kw">aggregate</span>(thickness<span class="op">~</span>diet, jfr2013_atheroma, mean)</a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co"># Add points for group means to boxplot</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="kw">points</span>(means<span class="op">$</span>thickness, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="dv">23</span>, <span class="dt">bg=</span><span class="dv">0</span>, <span class="dt">lwd=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb23-21" data-line-number="21"></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co"># X axis</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, <span class="dt">labels=</span><span class="kw">levels</span>(categories), <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb23-24" data-line-number="24"></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co"># Y axis</span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="aorta-hsp70" class="section level4">
<h4>Aorta Hsp70</h4>
<p>Aorta Hsp70 data from Smith BW J Ultrasound Med 2015 (doi: <a href="https://doi.org/10.7863/ultra.34.7.1209">10.7863/ultra.34.7.1209</a>).</p>
<div id="import-dataset-1" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">AortaHsp70 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/t_test_jum2015_hsp70.csv&#39;</span>,</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">                         <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">                         )</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="kw">attach</span>(AortaHsp70)</a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="kw">names</span>(AortaHsp70)</a></code></pre></div>
<pre><code>## [1] &quot;exposure&quot; &quot;Hsp70&quot;</code></pre>
</div>
<div id="perform-t-test-1" class="section level5">
<h5>Perform t-test</h5>
<ul>
<li>The default assumes unequal variance and applies the Satterthwaite/Welch df modification.</li>
<li>var.equal = TRUE is used to specify equal variances and a pooled variance estimate.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">t.test</span>(AortaHsp70<span class="op">$</span>Hsp70<span class="op">~</span>AortaHsp70<span class="op">$</span>exposure, </a>
<a class="sourceLine" id="cb26-2" data-line-number="2">       <span class="dt">paired=</span><span class="ot">FALSE</span>, <span class="dt">alternative=</span><span class="st">&#39;two.sided&#39;</span>,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">       <span class="dt">var.equal=</span><span class="ot">TRUE</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4">       ) </a></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  AortaHsp70$Hsp70 by AortaHsp70$exposure
## t = -0.91363, df = 22, p-value = 0.3708
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.11935215  0.04635215
## sample estimates:
## mean in group Definity   mean in group Saline 
##                 0.2575                 0.2940</code></pre>
</div>
<div id="test-assumptions-1" class="section level5">
<h5>Test assumptions</h5>
<p>The t test uses raw data, not residuals, so assumptions are tested using raw data.</p>
<div id="normality-1" class="section level6">
<h6>Normality</h6>
<ul>
<li>The RColorBrewer package is loaded for additional colors, and a palette is added to R. Use brackets after vector name for specific colors when creating plots (for example: <code>col=set1[4:14]</code>).</li>
<li>Legend can also be manually positioned with xy coordinates (numbers from 0,0 at bottom left of whole plot to 1,1 at top right)</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Shapiro-Wilk W test</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">shapiro.test</span>(AortaHsp70<span class="op">$</span>Hsp70)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  AortaHsp70$Hsp70
## W = 0.90895, p-value = 0.03347</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Normal Quantile-Quantile Plot</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co"># Set graphical parameters</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="dv">3</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">    <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">lend =</span> <span class="dv">0</span>, <span class="dt">ljoin =</span> <span class="dv">0</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">    <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">    )</a>
<a class="sourceLine" id="cb30-7" data-line-number="7"></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co"># Load RColorBrewer and set palette</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb30-10" data-line-number="10">set1 &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Set1&#39;</span>)</a>
<a class="sourceLine" id="cb30-11" data-line-number="11"></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="co"># Create vector for categories</span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13">categories &lt;-<span class="st"> </span><span class="kw">factor</span>(AortaHsp70<span class="op">$</span>exposure)</a>
<a class="sourceLine" id="cb30-14" data-line-number="14"></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="co"># Create plot</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="kw">qqnorm</span>(Hsp70,</a>
<a class="sourceLine" id="cb30-17" data-line-number="17">       <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">bold</span>(<span class="kw">paste</span>(<span class="st">&#39;Hsp70/&#39;</span>,beta, <span class="st">&#39;-actin&#39;</span>))), </a>
<a class="sourceLine" id="cb30-18" data-line-number="18">       <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col=</span>set1[categories], <span class="dt">lwd=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb30-19" data-line-number="19">       )</a>
<a class="sourceLine" id="cb30-20" data-line-number="20"><span class="co"># Add normal line</span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="kw">qqline</span>(AortaHsp70<span class="op">$</span>Hsp70, <span class="dt">lwd=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb30-22" data-line-number="22"><span class="co"># Add border to complete axes</span></a>
<a class="sourceLine" id="cb30-23" data-line-number="23"><span class="kw">box</span>(<span class="dt">which =</span> <span class="st">&#39;plot&#39;</span>, <span class="dt">bty =</span> <span class="st">&#39;o&#39;</span>, <span class="dt">lwd=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb30-24" data-line-number="24"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>) <span class="co"># x axis</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>) <span class="co"># y axis</span></a>
<a class="sourceLine" id="cb30-26" data-line-number="26"><span class="co"># Add legend</span></a>
<a class="sourceLine" id="cb30-27" data-line-number="27"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="dt">legend=</span><span class="kw">levels</span>(categories),</a>
<a class="sourceLine" id="cb30-28" data-line-number="28">       <span class="dt">box.lwd=</span><span class="dv">3</span>, <span class="dt">pch=</span><span class="fl">1.5</span>, <span class="dt">cex=</span><span class="fl">1.75</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>, <span class="dt">pt.lwd=</span><span class="dv">4</span>, <span class="dt">col=</span>set1</a>
<a class="sourceLine" id="cb30-29" data-line-number="29">       )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="equality-of-variances-1" class="section level6">
<h6>Equality of variances</h6>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">var.test</span>(AortaHsp70<span class="op">$</span>Hsp70<span class="op">~</span>AortaHsp70<span class="op">$</span>exposure)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  AortaHsp70$Hsp70 by AortaHsp70$exposure
## F = 0.38929, num df = 11, denom df = 11, p-value = 0.1328
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.1120669 1.3522650
## sample estimates:
## ratio of variances 
##          0.3892868</code></pre>
</div>
</div>
<div id="boxplot-1" class="section level5">
<h5>Boxplot</h5>
<ul>
<li><strong>Parameters (<code>par</code>):</strong> Graphical parameters need to be set again because of code chunk separation in RMarkdown. Normally they would only be set once per R session.</li>
<li><strong>X axis:</strong> The default axes will usually detect categorical data and label axes accordingly, but categories will need to be specified for axes created separately. It is easiest to create a separate vector with the categories, and then reference it when creating the plot. Labels can also be specified with <code>labels=c('group1', 'group2')</code>.</li>
<li><strong>Y axis:</strong> Note that it does not always start at zero, but encompasses the data range with some padding.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># Set graphical parameters</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="dv">3</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">    <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">lend =</span> <span class="dv">0</span>, <span class="dt">ljoin =</span> <span class="dv">0</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, </a>
<a class="sourceLine" id="cb33-4" data-line-number="4">    <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">    )</a>
<a class="sourceLine" id="cb33-6" data-line-number="6"></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co"># Create boxplot</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="kw">boxplot</span>(AortaHsp70<span class="op">$</span>Hsp70<span class="op">~</span>AortaHsp70<span class="op">$</span>exposure, <span class="dt">main=</span><span class="st">&#39;Aorta Hsp70&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Exposure&#39;</span>,</a>
<a class="sourceLine" id="cb33-9" data-line-number="9">        <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">bold</span>(<span class="kw">paste</span>(<span class="st">&#39;Hsp70/&#39;</span>,beta, <span class="st">&#39;-actin&#39;</span>))),</a>
<a class="sourceLine" id="cb33-10" data-line-number="10">        <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">lwd=</span><span class="dv">4</span>, <span class="dt">medlwd=</span><span class="dv">7</span>, <span class="dt">outlwd=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">col=</span>set1</a>
<a class="sourceLine" id="cb33-11" data-line-number="11">        )</a>
<a class="sourceLine" id="cb33-12" data-line-number="12"></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="co"># Add border to complete axes</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14"><span class="kw">box</span>(<span class="dt">which =</span> <span class="st">&#39;plot&#39;</span>, <span class="dt">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">lwd =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-15" data-line-number="15"></a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="co"># Create vector with means of each group</span></a>
<a class="sourceLine" id="cb33-17" data-line-number="17">means &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Hsp70<span class="op">~</span>exposure, AortaHsp70, mean)</a>
<a class="sourceLine" id="cb33-18" data-line-number="18"><span class="co"># Add points for group means to boxplot</span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="kw">points</span>(means<span class="op">$</span>Hsp70, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="dv">23</span>, <span class="dt">bg=</span><span class="dv">0</span>, <span class="dt">lwd=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb33-20" data-line-number="20"></a>
<a class="sourceLine" id="cb33-21" data-line-number="21"><span class="co"># X axis</span></a>
<a class="sourceLine" id="cb33-22" data-line-number="22"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, <span class="dt">labels=</span><span class="kw">levels</span>(categories), <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb33-23" data-line-number="23"></a>
<a class="sourceLine" id="cb33-24" data-line-number="24"><span class="co"># Y axis</span></a>
<a class="sourceLine" id="cb33-25" data-line-number="25"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="linear-regression" class="section level3">
<h3>Linear regression</h3>
<div id="simple-linear-regression-aztcpm" class="section level4">
<h4>Simple linear regression aztcpm</h4>
<p><code>aztcpm</code> dataset from University of Illinois statistics course PATH 591 <a href="https://drive.google.com/file/d/1XoeFzmbDLRAVkrtZ5dFpNprjwLAiHS-A/view?usp=sharing">lab 02</a> and <a href="https://drive.google.com/file/d/1BLG5s81lyWEMBlzlYFpSQRKwK9jZOX08/view?usp=sharing">Lecture 04 A</a></p>
<div id="intro" class="section level5">
<h5>Intro</h5>
<blockquote>
<p>These data are from an in-vitro study of the effect of AZT dose on DNA replication (CPM) for FeLV (feline leukemia virus). (The experimental unit is the cell culture sample). For the linear regression analysis, the dependent variable is CPM (counts per minute, indicating quantity of Feline Leukemia Virus DNA in a cell culture) and the independent (predictor) variable is DOSE (dose of AZT).</p>
</blockquote>
</div>
<div id="import-dataset-2" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">aztcpm &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/lm_aztcpm.csv&#39;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span>)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw">attach</span>(aztcpm)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="kw">names</span>(aztcpm)</a></code></pre></div>
<pre><code>## [1] &quot;DOSE&quot; &quot;CPM&quot;</code></pre>
</div>
<div id="perform-linear-regression" class="section level5">
<h5>Perform linear regression</h5>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(CPM <span class="op">~</span><span class="st"> </span>DOSE)</a></code></pre></div>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">gvlmalm1 &lt;-<span class="st"> </span><span class="kw">gvlma</span>(lm1)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="kw">summary</span>(gvlmalm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = CPM ~ DOSE)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -8712  -5708  -2483   3224  21640 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 39810.58    1711.46  23.261  &lt; 2e-16 ***
## DOSE         -813.61      89.45  -9.096 2.93e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8215 on 31 degrees of freedom
## Multiple R-squared:  0.7274, Adjusted R-squared:  0.7186 
## F-statistic: 82.73 on 1 and 31 DF,  p-value: 2.931e-10
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = lm1) 
## 
##                     Value   p-value                   Decision
## Global Stat        32.863 1.274e-06 Assumptions NOT satisfied!
## Skewness            9.168 2.463e-03 Assumptions NOT satisfied!
## Kurtosis            1.413 2.346e-01    Assumptions acceptable.
## Link Function      12.218 4.733e-04 Assumptions NOT satisfied!
## Heteroscedasticity 10.064 1.512e-03 Assumptions NOT satisfied!</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(lm1))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(lm1)
## W = 0.85782, p-value = 0.0005083</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(lm1), <span class="kw">abs</span>(<span class="kw">rstandard</span>(lm1)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(lm1), abs(rstandard(lm1)), method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(lm1) and abs(rstandard(lm1))
## S = 6160.8, p-value = 0.8704
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.0295404</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">durbinWatsonTest</span>(lm1)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1        0.797716     0.1772224       0
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">outlierTest</span>(lm1)</a></code></pre></div>
<pre><code>## No Studentized residuals with Bonferonni p &lt; 0.05
## Largest |rstudent|:
##    rstudent unadjusted p-value Bonferonni p
## 33 3.027239          0.0050324      0.16607</code></pre>
</div>
<div id="generate-plots" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">plot</span>(gvlmalm1, <span class="dt">onepage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-20-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-6.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">plot</span>(lm1, <span class="dt">which=</span><span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-20-7.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-8.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-20-9.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">acf</span>(<span class="kw">rstandard</span>(lm1), <span class="dt">main=</span><span class="st">&#39;Autocorrelation plot&#39;</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-20-10.png" width="672" /></p>
</div>
<div id="log-transform" class="section level5">
<h5>Log transform</h5>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">lmlog &lt;-<span class="st"> </span><span class="kw">update</span>(lm1, <span class="kw">log</span>(CPM)<span class="op">~</span>DOSE)</a></code></pre></div>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-1" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<p>Log transformation improves compliance with linear model assumptions. Some serial correlation remains, which is evident in plots of residuals vs fitted values and in the significant result of the Durbin-Watson D test, but it is within acceptable limits of the global validation of linear model assumptions.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">gvlmalog &lt;-<span class="st"> </span><span class="kw">gvlma</span>(lmlog)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="kw">summary</span>(gvlmalog)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(CPM) ~ DOSE)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57193 -0.11370 -0.02660  0.08659  0.46827 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.66086    0.04420  241.20   &lt;2e-16 ***
## DOSE        -0.05144    0.00231  -22.27   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2122 on 31 degrees of freedom
## Multiple R-squared:  0.9412, Adjusted R-squared:  0.9393 
## F-statistic: 495.8 on 1 and 31 DF,  p-value: &lt; 2.2e-16
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = lmlog) 
## 
##                       Value p-value                Decision
## Global Stat        3.952318 0.41250 Assumptions acceptable.
## Skewness           0.056280 0.81248 Assumptions acceptable.
## Kurtosis           0.676082 0.41094 Assumptions acceptable.
## Link Function      0.004124 0.94880 Assumptions acceptable.
## Heteroscedasticity 3.215833 0.07293 Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(lmlog))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(lmlog)
## W = 0.94082, p-value = 0.07176</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(lmlog), <span class="kw">abs</span>(<span class="kw">rstandard</span>(lmlog)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(lmlog), abs(rstandard(lmlog)), method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(lmlog) and abs(rstandard(lmlog))
## S = 6684, p-value = 0.5168
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.1169866</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(lmlog)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1       0.4659162     0.7381887       0
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">outlierTest</span>(lmlog)</a></code></pre></div>
<pre><code>##    rstudent unadjusted p-value Bonferonni p
## 1 -3.574629          0.0012106      0.03995</code></pre>
</div>
<div id="generate-plots-1" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">plot</span>(gvlmalog, <span class="dt">onepage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-23-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-6.png" width="672" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">plot</span>(lmlog, <span class="dt">which=</span><span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-23-7.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-8.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-23-9.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">acf</span>(<span class="kw">rstandard</span>(lmlog), <span class="dt">main=</span><span class="st">&#39;Autocorrelation plot&#39;</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-23-10.png" width="672" /></p>
</div>
</div>
<div id="simple-linear-regression-jfs-data" class="section level4">
<h4>Simple linear regression jfs data</h4>
<p>Feed intake vs total cholesterol data from Smith BW J Food Sci 2015 (doi: <a href="https://doi.org/10.1111/1750-3841.12968">10.1111/1750-3841.12968</a>).</p>
<div id="import-dataset-3" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">feedtc &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/lm_jfs2015_feed_vs_tc.csv&#39;</span>,</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">                     <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3">                     )</a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="kw">attach</span>(feedtc)</a></code></pre></div>
<pre><code>## The following object is masked from jfr2013_atheroma:
## 
##     diet</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">names</span>(feedtc)</a></code></pre></div>
<pre><code>## [1] &quot;id&quot;   &quot;diet&quot; &quot;tc&quot;   &quot;feed&quot;</code></pre>
</div>
<div id="perform-linear-regression-1" class="section level5">
<h5>Perform linear regression</h5>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">feedtclm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(feedtc<span class="op">$</span>tc<span class="op">~</span>feedtc<span class="op">$</span>feed)</a></code></pre></div>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-2" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<p>The dataset contains some potential outliers (M1356 and M1376), and a violation of the link function according to gvlma.</p>
<ul>
<li>Outliers
<ul>
<li>The major outlier is M1376, which returns a Cook’s D value of 0.43. This may or may not be an outlier, depending on the definition. It is just under the critical F value (F0.50(1,40)=0.463).</li>
<li>The Bonferroni outlier test does not identify any outliers either.</li>
<li>However, according to R in Action 8.4.3, Cook’s D values greater than 4/(n-k-1), where n is the sample size and k is the number of predictor variables, indicate influential observations (though he usually uses a cutoff of 1). M1376 would be considered an outlier by this definition.</li>
</ul></li>
<li>Link function
<ul>
<li>The link function violation is difficult to address. The dataset conforms to a normal distribution as evidenced by the normal probability plot and Shapiro-Wilk W test, so it would not seem like a concern, but it is enough to violate gvlma. However, this doesn’t seem like a situation where it would be neccessary to switch to another model (such as a generalized linear mixed model) and specify a different link function.</li>
<li>The Spearman rank order correlation between absolute values of residuals and predicted values returns a significant result, but heteroscedasticity is within acceptable limits according to gvlma and by visual inspection of plots of residuals vs. fitted values and autocorrelation.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2">feedtcgvlmalm1 &lt;-<span class="st"> </span><span class="kw">gvlma</span>(feedtclm1)</a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="kw">summary</span>(feedtcgvlmalm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = feedtc$tc ~ feedtc$feed)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -465.42 -208.18   11.74  168.20  449.91 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -470.33     232.65  -2.022   0.0489 *  
## feedtc$feed    77.39      14.94   5.179 4.58e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 239.6 on 47 degrees of freedom
## Multiple R-squared:  0.3633, Adjusted R-squared:  0.3498 
## F-statistic: 26.82 on 1 and 47 DF,  p-value: 4.578e-06
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = feedtclm1) 
## 
##                       Value   p-value                   Decision
## Global Stat        15.17502 0.0043516 Assumptions NOT satisfied!
## Skewness            0.03692 0.8476301    Assumptions acceptable.
## Kurtosis            1.62599 0.2022584    Assumptions acceptable.
## Link Function      13.31102 0.0002639 Assumptions NOT satisfied!
## Heteroscedasticity  0.20109 0.6538402    Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(feedtclm1))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(feedtclm1)
## W = 0.97342, p-value = 0.3295</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(feedtclm1), <span class="kw">abs</span>(<span class="kw">rstandard</span>(feedtclm1)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(feedtclm1), abs(rstandard(feedtclm1)), :
## Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(feedtclm1) and abs(rstandard(feedtclm1))
## S = 25989, p-value = 0.02227
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.3259777</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(feedtclm1)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1       0.4305706      1.065764       0
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">outlierTest</span>(feedtclm1)</a></code></pre></div>
<pre><code>## No Studentized residuals with Bonferonni p &lt; 0.05
## Largest |rstudent|:
##     rstudent unadjusted p-value Bonferonni p
## 45 -2.208409           0.032238           NA</code></pre>
</div>
<div id="generate-plots-2" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">plot</span>(feedtcgvlmalm1, <span class="dt">onepage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-27-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-27-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-27-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-27-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-27-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-27-6.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">plot</span>(feedtclm1, <span class="dt">which=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-27-7.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">cookscritical &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">/</span>(<span class="kw">nrow</span>(feedtc)<span class="op">-</span><span class="kw">length</span>(feedtclm1<span class="op">$</span>coefficients)<span class="op">-</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="kw">plot</span>(feedtclm1, <span class="dt">which=</span><span class="dv">4</span>, <span class="dt">cook.levels=</span>cookscritical)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">h=</span>cookscritical, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-27-8.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">plot</span>(feedtclm1, <span class="dt">which=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-27-9.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">acf</span>(<span class="kw">rstandard</span>(feedtclm1), <span class="dt">main=</span><span class="st">&#39;Autocorrelation plot&#39;</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-27-10.png" width="672" /></p>
</div>
<div id="calculate-spearman-correlation" class="section level5">
<h5>Calculate Spearman correlation</h5>
<p>The Spearman rank order correlation between the independent and dependent variable is another type of correlation that is more widely valid, especially in situations where F test assumptions are violated.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">cor.test</span>(feedtc<span class="op">$</span>tc, feedtc<span class="op">$</span>feed, <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(feedtc$tc, feedtc$feed, method = &quot;spearman&quot;):
## Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  feedtc$tc and feedtc$feed
## S = 8028.4, p-value = 8.003e-06
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.5903873</code></pre>
</div>
</div>
<div id="multiple-linear-regression-and-anova-example" class="section level4">
<h4>Multiple linear regression and ANOVA example</h4>
<p>This dataset from Doug Simpson at University of Illinois contains information on the number of calories in various beers, along with their percent alcohol and brewery.</p>
<p><code>PercentAlcohol</code> is a quantitative continuous independent variable and Brewery is a categorical independent variable.</p>
<div id="import-dataset-4" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">beer &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/anova_mlr_beer.csv&#39;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span>)</a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="kw">attach</span>(beer)</a></code></pre></div>
</div>
<div id="perform-multiple-linear-regression-in-lm" class="section level5">
<h5>Perform multiple linear regression in lm</h5>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">beerlm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(beer<span class="op">$</span>Calories <span class="op">~</span><span class="st"> </span>beer<span class="op">$</span>PercentAlcohol <span class="op">+</span><span class="st"> </span>beer<span class="op">$</span>Brewery)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="kw">anova</span>(beerlm1)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: beer$Calories
##                     Df  Sum Sq Mean Sq  F value  Pr(&gt;F)    
## beer$PercentAlcohol  1 17914.2 17914.2 102.3698 7.9e-13 ***
## beer$Brewery         8  4424.9   553.1   3.1608 0.00682 ** 
## Residuals           42  7349.8   175.0                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-3" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb95-2" data-line-number="2">beergvlmalm1 &lt;-<span class="st"> </span><span class="kw">gvlma</span>(beerlm1)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="kw">summary</span>(beergvlmalm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = beer$Calories ~ beer$PercentAlcohol + beer$Brewery)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -28.0179  -6.4610   0.6312  10.2197  25.3521 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     -36.937     17.061  -2.165  0.03612 *  
## beer$PercentAlcohol              33.812      3.439   9.831 1.86e-12 ***
## beer$BreweryAnchor               24.258     14.152   1.714  0.09389 .  
## beer$BreweryAnheuser Busch        2.150      6.400   0.336  0.73858    
## beer$BreweryD. G. Yuengling      20.088      7.825   2.567  0.01391 *  
## beer$BreweryG. Heileman          17.115     10.722   1.596  0.11795    
## beer$BreweryHigh Falls Brewing   17.996      8.382   2.147  0.03762 *  
## beer$BreweryLeinenkugel          24.470      7.077   3.458  0.00126 ** 
## beer$BreweryMiller               10.801      6.206   1.740  0.08911 .  
## beer$BreweryPabst                29.021     10.607   2.736  0.00908 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.23 on 42 degrees of freedom
## Multiple R-squared:  0.7524, Adjusted R-squared:  0.6994 
## F-statistic: 14.18 on 9 and 42 DF,  p-value: 3.745e-10
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = beerlm1) 
## 
##                      Value   p-value                   Decision
## Global Stat        16.8557 0.0020618 Assumptions NOT satisfied!
## Skewness            1.0664 0.3017523    Assumptions acceptable.
## Kurtosis            0.3225 0.5700957    Assumptions acceptable.
## Link Function      14.4847 0.0001413 Assumptions NOT satisfied!
## Heteroscedasticity  0.9820 0.3216947    Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(beerlm1))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(beerlm1)
## W = 0.97308, p-value = 0.2957</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(beerlm1), <span class="kw">abs</span>(<span class="kw">rstandard</span>(beerlm1)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(beerlm1), abs(rstandard(beerlm1)),
## method = &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(beerlm1) and abs(rstandard(beerlm1))
## S = 19070, p-value = 0.3374
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.1371004</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(beerlm1)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1      0.07781896      1.843075   0.182
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">leveneTest</span>(beer<span class="op">$</span>Calories, beer<span class="op">$</span>Brewery)</a></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  8  0.8577 0.5587
##       43</code></pre>
</div>
<div id="generate-plots-3" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">plot</span>(beergvlmalm1, <span class="dt">onepage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-32-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-6.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-7.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-8.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-9.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-10.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-11.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-12.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-13.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-14.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">plot</span>(beerlm1, <span class="dt">which=</span><span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Warning: not plotting observations with leverage one:
##   1</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-32-15.png" width="672" /></p>
<pre><code>## Warning: not plotting observations with leverage one:
##   1</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-32-16.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-32-17.png" width="672" /></p>
</div>
<div id="perform-anova-in-aov-for-comparison" class="section level5">
<h5>Perform ANOVA in aov for comparison</h5>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">beeraov1 &lt;-<span class="st"> </span><span class="kw">aov</span>(beer<span class="op">$</span>Calories <span class="op">~</span><span class="st"> </span>beer<span class="op">$</span>PercentAlcohol <span class="op">+</span><span class="st"> </span>beer<span class="op">$</span>Brewery)</a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="kw">summary</span>(beeraov1)</a></code></pre></div>
<pre><code>##                     Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## beer$PercentAlcohol  1  17914   17914 102.370 7.9e-13 ***
## beer$Brewery         8   4425     553   3.161 0.00682 ** 
## Residuals           42   7350     175                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">plot</span>(beeraov1)</a></code></pre></div>
<pre><code>## Warning: not plotting observations with leverage one:
##   1</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-33-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<pre><code>## Warning: not plotting observations with leverage one:
##   1</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-33-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-33-4.png" width="672" /></p>
</div>
</div>
</div>
<div id="anova" class="section level3">
<h3>ANOVA</h3>
<div id="one-way-anova-example" class="section level4">
<h4>One-way ANOVA example</h4>
<p>Gonadal adipose weights from Smith BW J Food Sci 2015 (doi: <a href="https://doi.org/10.1111/1750-3841.12968">10.1111/1750-3841.12968</a>).</p>
<div id="import-dataset-5" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1">adipose_weights &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/anova_one_way_jfs2015_adipose.csv&#39;</span>,</a>
<a class="sourceLine" id="cb115-2" data-line-number="2">                              <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span></a>
<a class="sourceLine" id="cb115-3" data-line-number="3">                              )</a>
<a class="sourceLine" id="cb115-4" data-line-number="4"><span class="kw">attach</span>(adipose_weights)</a></code></pre></div>
<pre><code>## The following objects are masked from feedtc:
## 
##     diet, id</code></pre>
<pre><code>## The following object is masked from jfr2013_atheroma:
## 
##     diet</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="kw">names</span>(adipose_weights)</a></code></pre></div>
<pre><code>## [1] &quot;id&quot;      &quot;diet&quot;    &quot;adipose&quot;</code></pre>
</div>
<div id="perform-anova-in-aov" class="section level5">
<h5>Perform ANOVA in aov</h5>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">adiposeaov1 &lt;-<span class="st"> </span><span class="kw">aov</span>(adipose<span class="op">~</span>diet, <span class="dt">data=</span>adipose_weights)</a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="kw">summary</span>(adiposeaov1)</a></code></pre></div>
<pre><code>##             Df   Sum Sq   Mean Sq F value   Pr(&gt;F)    
## diet         4 0.002509 0.0006271   9.949 9.35e-06 ***
## Residuals   42 0.002648 0.0000630                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 2 observations deleted due to missingness</code></pre>
</div>
<div id="perform-multiple-comparisons" class="section level5">
<h5>Perform multiple comparisons</h5>
<ul>
<li>The RColorBrewer package is loaded for additional colors, and a palette is added to R. Use brackets after vector name for specific colors when creating plots (for example: <code>col=set1[4:14]</code>).</li>
<li>I chose the <code>Pastel1</code> palette. ‘I’m a very vivacious man… Earth tones are so passe. I’m a pastel man.’ Larry David</li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1"><span class="co"># Standard Tukey Honest Significant Differences</span></a>
<a class="sourceLine" id="cb122-2" data-line-number="2"><span class="kw">TukeyHSD</span>(adiposeaov1)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = adipose ~ diet, data = adipose_weights)
## 
## $diet
##                     diff          lwr         upr     p adj
## WD-AIN       0.013272442  0.002278112 0.024266773 0.0109966
## WDSG-AIN     0.007630272 -0.003102252 0.018362795 0.2716464
## WDTP-AIN     0.018925192  0.008192669 0.029657715 0.0000924
## WDTPSG-AIN   0.020266814  0.009534291 0.030999337 0.0000292
## WDSG-WD     -0.005642171 -0.016038167 0.004753826 0.5389261
## WDTP-WD      0.005652750 -0.004743247 0.016048746 0.5371109
## WDTPSG-WD    0.006994372 -0.003401625 0.017390368 0.3242717
## WDTP-WDSG    0.011294920  0.001176200 0.021413640 0.0219233
## WDTPSG-WDSG  0.012636542  0.002517823 0.022755262 0.0079286
## WDTPSG-WDTP  0.001341622 -0.008777098 0.011460342 0.9955000</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">las=</span><span class="dv">2</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb124-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(adiposeaov1))</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="co"># More comprehensive method in multcomp package</span></a>
<a class="sourceLine" id="cb125-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">las=</span><span class="dv">1</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb125-3" data-line-number="3"><span class="kw">library</span>(multcomp)</a></code></pre></div>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb132-2" data-line-number="2">tuk &lt;-<span class="st"> </span><span class="kw">glht</span>(adiposeaov1, <span class="dt">linfct=</span><span class="kw">mcp</span>(<span class="dt">diet=</span><span class="st">&#39;Tukey&#39;</span>))</a>
<a class="sourceLine" id="cb132-3" data-line-number="3">means &lt;-<span class="st"> </span><span class="kw">aggregate</span>(adipose<span class="op">~</span>diet, adipose_weights, mean)</a>
<a class="sourceLine" id="cb132-4" data-line-number="4"><span class="kw">plot</span>(<span class="kw">cld</span>(tuk, <span class="dt">level=</span>.<span class="dv">05</span>), <span class="dt">col=</span><span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&#39;Pastel1&#39;</span>))</a>
<a class="sourceLine" id="cb132-5" data-line-number="5"><span class="kw">points</span>(means,<span class="dt">pch=</span><span class="dv">23</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
</div>
<div id="test-assumptions-2" class="section level5">
<h5>Test assumptions</h5>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">plot</span>(adiposeaov1)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-37-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-37-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-37-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-37-4.png" width="672" /></p>
<div id="normality-2" class="section level6">
<h6>Normality</h6>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="co"># Shapiro-Wilk W test</span></a>
<a class="sourceLine" id="cb134-2" data-line-number="2"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(adiposeaov1))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(adiposeaov1)
## W = 0.97688, p-value = 0.4704</code></pre>
</div>
<div id="equality-of-variances-2" class="section level6">
<h6>Equality of variances</h6>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb136-2" data-line-number="2"><span class="kw">leveneTest</span>(adipose_weights<span class="op">$</span>adipose, adipose_weights<span class="op">$</span>diet)</a></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  4  0.5104 0.7284
##       42</code></pre>
</div>
</div>
<div id="perform-anova-in-lm-for-comparison" class="section level5">
<h5>Perform ANOVA in lm for comparison</h5>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">adiposelm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(adipose_weights<span class="op">$</span>adipose<span class="op">~</span>adipose_weights<span class="op">$</span>diet)</a>
<a class="sourceLine" id="cb138-2" data-line-number="2"><span class="kw">anova</span>(adiposelm1)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: adipose_weights$adipose
##                      Df    Sum Sq    Mean Sq F value    Pr(&gt;F)    
## adipose_weights$diet  4 0.0025086 0.00062714  9.9489 9.349e-06 ***
## Residuals            42 0.0026475 0.00006304                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-4" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb140-2" data-line-number="2">adiposegvlmalm1 &lt;-<span class="st"> </span><span class="kw">gvlma</span>(adiposelm1)</a>
<a class="sourceLine" id="cb140-3" data-line-number="3"><span class="kw">summary</span>(adiposegvlmalm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = adipose_weights$adipose ~ adipose_weights$diet)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0177688 -0.0054835 -0.0009354  0.0053295  0.0181588 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                0.018048   0.002807   6.430 9.57e-08 ***
## adipose_weights$dietWD     0.013272   0.003858   3.440  0.00133 ** 
## adipose_weights$dietWDSG   0.007630   0.003766   2.026  0.04914 *  
## adipose_weights$dietWDTP   0.018925   0.003766   5.025 9.81e-06 ***
## adipose_weights$dietWDTPSG 0.020267   0.003766   5.381 3.06e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.00794 on 42 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.4865, Adjusted R-squared:  0.4376 
## F-statistic: 9.949 on 4 and 42 DF,  p-value: 9.349e-06
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = adiposelm1) 
## 
##                        Value p-value                Decision
## Global Stat        1.372e+00  0.8491 Assumptions acceptable.
## Skewness           1.174e+00  0.2786 Assumptions acceptable.
## Kurtosis           3.779e-02  0.8459 Assumptions acceptable.
## Link Function      1.968e-16  1.0000 Assumptions acceptable.
## Heteroscedasticity 1.598e-01  0.6893 Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(adiposelm1))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(adiposelm1)
## W = 0.97688, p-value = 0.4704</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(adiposelm1), <span class="kw">abs</span>(<span class="kw">rstandard</span>(adiposelm1)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(adiposelm1),
## abs(rstandard(adiposelm1)), : Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(adiposelm1) and abs(rstandard(adiposelm1))
## S = 15074, p-value = 0.3894
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.1284718</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb147-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(adiposelm1)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1      -0.1135751      2.212731   0.858
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1"><span class="kw">outlierTest</span>(adiposelm1)</a></code></pre></div>
<pre><code>## No Studentized residuals with Bonferonni p &lt; 0.05
## Largest |rstudent|:
##    rstudent unadjusted p-value Bonferonni p
## 13 2.584726           0.013403      0.62992</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="kw">leveneTest</span>(adipose_weights<span class="op">$</span>adipose, adipose_weights<span class="op">$</span>diet)</a></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  4  0.5104 0.7284
##       42</code></pre>
</div>
</div>
<div id="two-way-factorial-anova-example" class="section level4">
<h4>Two-way factorial ANOVA example</h4>
<p>R in Action 9.5, ToothGrowth dataset</p>
<blockquote>
<p>This example uses the ToothGrowth dataset in the base installation to demonstrate a two-way between-groups ANOVA. Sixty guinea pigs are randomly assigned to receive one of three levels of ascorbic acid (0.5, 1, or 2mg), and one of two delivery methods (orange juice or Vitamin C), under the restriction that each treatment combination has 10 guinea pigs. The dependent variable is tooth length.</p>
</blockquote>
<div id="load-dataset" class="section level5">
<h5>Load dataset</h5>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1"><span class="kw">attach</span>(ToothGrowth)</a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="kw">table</span>(supp, dose)</a></code></pre></div>
<pre><code>##     dose
## supp 0.5  1  2
##   OJ  10 10 10
##   VC  10 10 10</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="kw">aggregate</span>(len, <span class="dt">by=</span><span class="kw">list</span>(supp, dose), <span class="dt">FUN=</span>mean)</a></code></pre></div>
<pre><code>##   Group.1 Group.2     x
## 1      OJ     0.5 13.23
## 2      VC     0.5  7.98
## 3      OJ     1.0 22.70
## 4      VC     1.0 16.77
## 5      OJ     2.0 26.06
## 6      VC     2.0 26.14</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="kw">aggregate</span>(len, <span class="dt">by=</span><span class="kw">list</span>(supp, dose), <span class="dt">FUN=</span>sd)</a></code></pre></div>
<pre><code>##   Group.1 Group.2        x
## 1      OJ     0.5 4.459709
## 2      VC     0.5 2.746634
## 3      OJ     1.0 3.910953
## 4      VC     1.0 2.515309
## 5      OJ     2.0 2.655058
## 6      VC     2.0 4.797731</code></pre>
</div>
<div id="perform-factorial-analysis-of-variance" class="section level5">
<h5>Perform factorial analysis of variance</h5>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(len<span class="op">~</span>supp<span class="op">*</span>dose)</a>
<a class="sourceLine" id="cb159-2" data-line-number="2"><span class="kw">anova</span>(fit)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: len
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## supp       1  205.35  205.35  12.3170 0.0008936 ***
## dose       1 2224.30 2224.30 133.4151 &lt; 2.2e-16 ***
## supp:dose  1   88.92   88.92   5.3335 0.0246314 *  
## Residuals 56  933.63   16.67                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-5" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb161-2" data-line-number="2">gvlmafit &lt;-<span class="st"> </span><span class="kw">gvlma</span>(fit)</a>
<a class="sourceLine" id="cb161-3" data-line-number="3"><span class="kw">summary</span>(gvlmafit)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = len ~ supp * dose)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2264 -2.8462  0.0504  2.2893  7.9386 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   11.550      1.581   7.304 1.09e-09 ***
## suppVC        -8.255      2.236  -3.691 0.000507 ***
## dose           7.811      1.195   6.534 2.03e-08 ***
## suppVC:dose    3.904      1.691   2.309 0.024631 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.083 on 56 degrees of freedom
## Multiple R-squared:  0.7296, Adjusted R-squared:  0.7151 
## F-statistic: 50.36 on 3 and 56 DF,  p-value: 6.521e-16
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = fit) 
## 
##                      Value  p-value                   Decision
## Global Stat        10.6646 0.030604 Assumptions NOT satisfied!
## Skewness            0.0934 0.759902    Assumptions acceptable.
## Kurtosis            1.0752 0.299778    Assumptions acceptable.
## Link Function       8.7812 0.003043 Assumptions NOT satisfied!
## Heteroscedasticity  0.7148 0.397854    Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(fit))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(fit)
## W = 0.98147, p-value = 0.4936</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(fit), <span class="kw">abs</span>(<span class="kw">rstandard</span>(fit)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(fit), abs(rstandard(fit)), method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(fit) and abs(rstandard(fit))
## S = 33376, p-value = 0.5812
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.0726424</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb168-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(fit)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1       0.1333076       1.68846   0.106
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="kw">outlierTest</span>(fit)</a></code></pre></div>
<pre><code>## No Studentized residuals with Bonferonni p &lt; 0.05
## Largest |rstudent|:
##     rstudent unadjusted p-value Bonferonni p
## 22 -2.185495           0.033129           NA</code></pre>
</div>
<div id="generate-plots-4" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1"><span class="kw">plot</span>(gvlmafit, <span class="dt">onepage=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-45-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-6.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-7.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-8.png" width="672" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" data-line-number="1"><span class="kw">plot</span>(fit, <span class="dt">which=</span><span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-45-9.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-10.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-45-11.png" width="672" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="kw">interaction.plot</span>(dose, supp, len, <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">18</span>), </a>
<a class="sourceLine" id="cb174-2" data-line-number="2">                 <span class="dt">main =</span> <span class="st">&#39;Interaction between Dose and Supplement Type&#39;</span></a>
<a class="sourceLine" id="cb174-3" data-line-number="3">                 )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-45-12.png" width="672" /></p>
</div>
</div>
<div id="two-way-factorial-anova-example-1" class="section level4">
<h4>Two-way factorial ANOVA example</h4>
<p>Atheroma thickness data from Smith BW et al, J Ultrasound Med 2012 (doi: <a href="https://doi.org/10.7863/jum.2012.31.5.711">10.7863/jum.2012.31.5.711</a>).</p>
<div id="import-dataset-6" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1">fall2009thickness &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/anova_factorial_jum2012_atheroma_thickness.csv&#39;</span>,</a>
<a class="sourceLine" id="cb175-2" data-line-number="2">                                <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span></a>
<a class="sourceLine" id="cb175-3" data-line-number="3">                                )</a>
<a class="sourceLine" id="cb175-4" data-line-number="4"><span class="kw">attach</span>(fall2009thickness)</a></code></pre></div>
<pre><code>## The following object is masked from adipose_weights:
## 
##     id</code></pre>
<pre><code>## The following object is masked from feedtc:
## 
##     id</code></pre>
<pre><code>## The following object is masked from jfr2013_atheroma:
## 
##     thickness</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1"><span class="kw">head</span>(fall2009thickness)</a></code></pre></div>
<pre><code>##     id      uca mpa thickness
## 1 L604 Definity   0        35
## 2 L611 Definity   0        10
## 3 L614 Definity   0        70
## 4 L617 Definity   0        60
## 5 L624 Definity   0       100
## 6 L593   Saline   0        50</code></pre>
</div>
<div id="perform-factorial-analysis-of-variance-1" class="section level5">
<h5>Perform factorial analysis of variance</h5>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1">thick_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(thickness<span class="op">~</span>uca<span class="op">*</span>mpa, <span class="dt">data=</span>fall2009thickness)</a>
<a class="sourceLine" id="cb181-2" data-line-number="2"><span class="kw">anova</span>(thick_fit)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: thickness
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## uca        1   9619  9618.9  4.6436 0.03775 *
## mpa        1   5255  5255.4  2.5371 0.11971  
## uca:mpa    1   3285  3285.1  1.5859 0.21580  
## Residuals 37  76643  2071.4                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-6" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb183-2" data-line-number="2">gvlmathick_fit &lt;-<span class="st"> </span><span class="kw">gvlma</span>(thick_fit)</a>
<a class="sourceLine" id="cb183-3" data-line-number="3"><span class="kw">summary</span>(gvlmathick_fit)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = thickness ~ uca * mpa, data = fall2009thickness)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -92.81 -26.34 -11.70  13.76 141.39 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)     49.026     16.802   2.918  0.00596 **
## ucaSaline        7.320     23.838   0.307  0.76053   
## mpa              3.608     12.762   0.283  0.77898   
## ucaSaline:mpa   23.278     18.484   1.259  0.21580   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 45.51 on 37 degrees of freedom
## Multiple R-squared:  0.1915, Adjusted R-squared:  0.126 
## F-statistic: 2.922 on 3 and 37 DF,  p-value: 0.04662
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = thick_fit) 
## 
##                      Value  p-value                   Decision
## Global Stat        15.0581 0.004582 Assumptions NOT satisfied!
## Skewness            5.2041 0.022534 Assumptions NOT satisfied!
## Kurtosis            4.1197 0.042388 Assumptions NOT satisfied!
## Link Function       0.9562 0.328138    Assumptions acceptable.
## Heteroscedasticity  4.7782 0.028823 Assumptions NOT satisfied!</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(thick_fit))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(thick_fit)
## W = 0.95015, p-value = 0.07084</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(thick_fit), <span class="kw">abs</span>(<span class="kw">rstandard</span>(thick_fit)), <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(thick_fit), abs(rstandard(thick_fit)), :
## Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(thick_fit) and abs(rstandard(thick_fit))
## S = 9118.5, p-value = 0.197
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.2057044</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb190-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(thick_fit)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1      -0.3832382       2.76177   0.042
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="kw">outlierTest</span>(thick_fit)</a></code></pre></div>
<pre><code>##    rstudent unadjusted p-value Bonferonni p
## 27 3.699668         0.00071694     0.029395</code></pre>
</div>
<div id="generate-plots-5" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1"><span class="kw">plot</span>(gvlmathick_fit, <span class="dt">onepage=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-49-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-6.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-7.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-8.png" width="672" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw">plot</span>(thick_fit, <span class="dt">which=</span><span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-49-9.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-10.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-49-11.png" width="672" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="kw">interaction.plot</span>(uca, mpa, thickness, <span class="dt">data=</span>fall2009thickness, </a>
<a class="sourceLine" id="cb196-2" data-line-number="2">                 <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">18</span>), </a>
<a class="sourceLine" id="cb196-3" data-line-number="3">                 <span class="dt">main =</span> <span class="st">&#39;Interaction between contrast agent and pressure level&#39;</span></a>
<a class="sourceLine" id="cb196-4" data-line-number="4">                 )</a></code></pre></div>
<pre><code>## Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
## a graphical parameter

## Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
## a graphical parameter</code></pre>
<pre><code>## Warning in box(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in axis(1, x, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-49-12.png" width="672" /></p>
</div>
<div id="log-transform-to-correct-non-normality-heteroscedasticity-and-outlier" class="section level5">
<h5>Log transform to correct non-normality, heteroscedasticity, and outlier</h5>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1">log_thick_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(thickness)<span class="op">~</span>uca<span class="op">*</span>mpa, <span class="dt">data=</span>fall2009thickness)</a>
<a class="sourceLine" id="cb203-2" data-line-number="2"><span class="kw">anova</span>(log_thick_fit)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log(thickness)
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## uca        1  2.4372 2.43722  4.1806 0.04805 *
## mpa        1  0.6951 0.69511  1.1923 0.28192  
## uca:mpa    1  0.3084 0.30843  0.5291 0.47158  
## Residuals 37 21.5703 0.58298                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="perform-regression-diagnostics-and-test-assumptions-7" class="section level5">
<h5>Perform regression diagnostics and test assumptions</h5>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb205-2" data-line-number="2">gvlma_log_thick_fit &lt;-<span class="st"> </span><span class="kw">gvlma</span>(log_thick_fit)</a>
<a class="sourceLine" id="cb205-3" data-line-number="3"><span class="kw">summary</span>(gvlma_log_thick_fit)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(thickness) ~ uca * mpa, data = fall2009thickness)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.51653 -0.50113  0.09291  0.44825  1.18425 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    3.64610    0.28187  12.935 2.67e-15 ***
## ucaSaline      0.26316    0.39991   0.658    0.515    
## mpa            0.06159    0.21410   0.288    0.775    
## ucaSaline:mpa  0.22555    0.31009   0.727    0.472    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7635 on 37 degrees of freedom
## Multiple R-squared:  0.1376, Adjusted R-squared:  0.06764 
## F-statistic: 1.967 on 3 and 37 DF,  p-value: 0.1358
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = log_thick_fit) 
## 
##                     Value p-value                Decision
## Global Stat        3.4821  0.4806 Assumptions acceptable.
## Skewness           2.1479  0.1428 Assumptions acceptable.
## Kurtosis           0.5245  0.4689 Assumptions acceptable.
## Link Function      0.6395  0.4239 Assumptions acceptable.
## Heteroscedasticity 0.1701  0.6800 Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(log_thick_fit))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(log_thick_fit)
## W = 0.93909, p-value = 0.02924</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="kw">cor.test</span>(<span class="kw">fitted</span>(log_thick_fit), </a>
<a class="sourceLine" id="cb209-2" data-line-number="2">         <span class="kw">abs</span>(<span class="kw">rstandard</span>(log_thick_fit)), </a>
<a class="sourceLine" id="cb209-3" data-line-number="3">         <span class="dt">method=</span><span class="st">&#39;spearman&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in cor.test.default(fitted(log_thick_fit),
## abs(rstandard(log_thick_fit)), : Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fitted(log_thick_fit) and abs(rstandard(log_thick_fit))
## S = 12639, p-value = 0.5298
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.1009924</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb212-2" data-line-number="2"><span class="kw">durbinWatsonTest</span>(log_thick_fit)</a></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1      -0.3411439      2.681506   0.036
##  Alternative hypothesis: rho != 0</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="kw">outlierTest</span>(log_thick_fit)</a></code></pre></div>
<pre><code>## No Studentized residuals with Bonferonni p &lt; 0.05
## Largest |rstudent|:
##     rstudent unadjusted p-value Bonferonni p
## 37 -2.276215           0.028882           NA</code></pre>
</div>
<div id="generate-plots-6" class="section level5">
<h5>Generate plots</h5>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="kw">plot</span>(gvlma_log_thick_fit, <span class="dt">onepage=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-52-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-4.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-5.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-6.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-7.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-8.png" width="672" /></p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="kw">plot</span>(log_thick_fit, <span class="dt">which=</span><span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-52-9.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-10.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-52-11.png" width="672" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1"><span class="kw">interaction.plot</span>(uca, mpa, thickness, <span class="dt">data=</span>fall2009thickness,</a>
<a class="sourceLine" id="cb218-2" data-line-number="2">                 <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">18</span>), </a>
<a class="sourceLine" id="cb218-3" data-line-number="3">                 <span class="dt">main =</span> <span class="st">&#39;Interaction between contrast agent and pressure level&#39;</span></a>
<a class="sourceLine" id="cb218-4" data-line-number="4">                 )</a></code></pre></div>
<pre><code>## Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
## a graphical parameter

## Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
## a graphical parameter</code></pre>
<pre><code>## Warning in box(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>## Warning in axis(1, x, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-52-12.png" width="672" /></p>
</div>
</div>
<div id="anova-compact-letter-display" class="section level4">
<h4>ANOVA Compact Letter Display</h4>
<p>Compact Letter Display (CLD) for ANOVA multiple comparisons with the <code>multcomp</code> package</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1"><span class="co"># multiple comparison procedures</span></a>
<a class="sourceLine" id="cb225-2" data-line-number="2"><span class="co"># set up a one-way ANOVA</span></a>
<a class="sourceLine" id="cb225-3" data-line-number="3"><span class="kw">library</span>(multcomp)</a>
<a class="sourceLine" id="cb225-4" data-line-number="4"><span class="kw">data</span>(warpbreaks)</a>
<a class="sourceLine" id="cb225-5" data-line-number="5">amod &lt;-<span class="st"> </span><span class="kw">aov</span>(breaks <span class="op">~</span><span class="st"> </span>tension, <span class="dt">data =</span> warpbreaks)</a>
<a class="sourceLine" id="cb225-6" data-line-number="6"><span class="co"># specify all pair-wise comparisons among levels of variable &#39;tension&#39;</span></a>
<a class="sourceLine" id="cb225-7" data-line-number="7">tuk &lt;-<span class="st"> </span><span class="kw">glht</span>(amod, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">tension =</span> <span class="st">&#39;Tukey&#39;</span>))</a>
<a class="sourceLine" id="cb225-8" data-line-number="8"><span class="co"># extract information</span></a>
<a class="sourceLine" id="cb225-9" data-line-number="9">tuk.cld &lt;-<span class="st"> </span><span class="kw">cld</span>(tuk)</a>
<a class="sourceLine" id="cb225-10" data-line-number="10"><span class="co"># use sufficiently large upper margin</span></a>
<a class="sourceLine" id="cb225-11" data-line-number="11">old.par &lt;-<span class="st"> </span><span class="kw">par</span>( <span class="dt">mai=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb225-12" data-line-number="12"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb225-13" data-line-number="13"><span class="kw">plot</span>(tuk.cld)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1"><span class="kw">par</span>(old.par)</a></code></pre></div>
</div>
</div>
<div id="repeated-measures-anova" class="section level3">
<h3>Repeated measures ANOVA</h3>
<div id="repeated-measures-anova-example" class="section level4">
<h4>Repeated measures ANOVA example</h4>
<p>R in Action 2nd ed, 9.6, CO2 dataset</p>
<p><strong>note that the code from the first edition may return errors</strong></p>
<blockquote>
<p>In addition to the base installation, we’ll be using the <code>car</code>, <code>gplots</code>, <code>HH</code>, <code>rrcov</code>, and <code>mvoutlier</code> packages in our examples. Be sure to install them before trying out the sample code.</p>
<p>The CO2 dataset included in the base installation contains the results of a study of cold tolerance in Northern and Southern plants of the grass species Echinochloa crus-galli (Potvin, Lechowicz, &amp; Tardif, 1990). The photosynthetic rates of chilled plants were compared with the photosynthetic rates of nonchilled plants at several ambient CO2 concentrations. Half the plants were from Quebec, and half were from Mississippi.</p>
<p>In this example, we’ll focus on chilled plants. The dependent variable is carbon dioxide uptake (uptake) in ml/L, and the independent variables are Type (Quebec versus Mississippi) and ambient CO2 concentration (conc) with seven levels (ranging from 95 to 1000 umol/m^2 sec). Type is a between-groups factor, and conc is a within- groups factor. Type is already stored as a factor, but you’ll need to convert conc to a factor before continuing. The analysis is presented in the next listing.</p>
</blockquote>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" data-line-number="1">CO2<span class="op">$</span>conc &lt;-<span class="st"> </span><span class="kw">factor</span>(CO2<span class="op">$</span>conc)</a>
<a class="sourceLine" id="cb227-2" data-line-number="2">w1b1 &lt;-<span class="st"> </span><span class="kw">subset</span>(CO2, Treatment<span class="op">==</span><span class="st">&#39;chilled&#39;</span>)</a>
<a class="sourceLine" id="cb227-3" data-line-number="3">co2_fit &lt;-<span class="st"> </span><span class="kw">aov</span>(uptake <span class="op">~</span><span class="st"> </span>conc<span class="op">*</span>Type <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(Plant<span class="op">/</span>(conc)), w1b1)</a>
<a class="sourceLine" id="cb227-4" data-line-number="4"><span class="kw">summary</span>(co2_fit)</a></code></pre></div>
<pre><code>## 
## Error: Plant
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Type       1 2667.2  2667.2   60.41 0.00148 **
## Residuals  4  176.6    44.1                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error: Plant:conc
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## conc       6 1472.4  245.40   52.52 1.26e-12 ***
## conc:Type  6  428.8   71.47   15.30 3.75e-07 ***
## Residuals 24  112.1    4.67                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">las=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb229-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb229-3" data-line-number="3"><span class="kw">with</span>(w1b1, <span class="kw">interaction.plot</span>(conc,Type,uptake,</a>
<a class="sourceLine" id="cb229-4" data-line-number="4">       <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">18</span>),</a>
<a class="sourceLine" id="cb229-5" data-line-number="5">       <span class="dt">main=</span><span class="st">&#39;Interaction Plot for Plant Type and Concentration&#39;</span>)</a>
<a class="sourceLine" id="cb229-6" data-line-number="6">     )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1"><span class="kw">boxplot</span>(uptake <span class="op">~</span><span class="st"> </span>Type<span class="op">*</span>conc, <span class="dt">data=</span>w1b1, <span class="dt">col=</span>(<span class="kw">c</span>(<span class="st">&#39;gold&#39;</span>, <span class="st">&#39;green&#39;</span>)),</a>
<a class="sourceLine" id="cb230-2" data-line-number="2">         <span class="dt">main=</span><span class="st">&#39;Chilled Quebec and Mississippi Plants&#39;</span>,</a>
<a class="sourceLine" id="cb230-3" data-line-number="3">          <span class="dt">ylab=</span><span class="st">&#39;Carbon dioxide uptake rate (umol/m^2 sec)&#39;</span></a>
<a class="sourceLine" id="cb230-4" data-line-number="4">        )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
<blockquote>
<p><strong>The many approaches to mixed-model designs</strong></p>
<p>The CO2 example in this section was analyzed using a traditional repeated measures ANOVA. The approach assumes that the covariance matrix for any within-groups factor follows a specified form known as sphericity. Specifically, it assumes that the vari- ances of the differences between any two levels of the within-groups factor are equal. In real-world data, it’s unlikely that this assumption will be met. This has led to a number of alternative approaches, including the following:</p>
<ul>
<li>Using the lmer() function in the lme4 package to fit linear mixed models (Bates, 2005)</li>
<li>Using the Anova() function in the car package to adjust traditional test statis- tics to account for lack of sphericity (for example, the Geisser–Greenhouse correction)</li>
<li>Using the gls() function in the nlme package to fit generalized least squares models with specified variance-covariance structures (UCLA, 2009)</li>
<li>Using multivariate analysis of variance to model repeated measured data (Hand, 1987)</li>
</ul>
<p>Coverage of these approaches is beyond the scope of this text. If you’re interested in learning more, check out Pinheiro and Bates (2000) and Zuur et al. (2009).</p>
</blockquote>
</div>
</div>
<div id="ancova" class="section level3">
<h3>ANCOVA</h3>
<div id="one-way-ancova-example" class="section level4">
<h4>One-way ANCOVA example</h4>
<p>R in Action 9.4, litter dataset from multcomp package</p>
<blockquote>
<p>Pregnant mice were divided into four treatment groups; each group received a different dose of a drug (0, 5, 50, or 500). The mean post-birth weight for each litter was the dependent variable and gestation time was included as a covariate. The analysis is given in the following listing.</p>
</blockquote>
<div id="load-dataset-1" class="section level5">
<h5>Load dataset</h5>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1"><span class="kw">library</span>(multcomp)</a>
<a class="sourceLine" id="cb231-2" data-line-number="2"><span class="kw">attach</span>(litter)</a></code></pre></div>
<pre><code>## The following object is masked from ToothGrowth:
## 
##     dose</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" data-line-number="1"><span class="kw">table</span>(dose)</a></code></pre></div>
<pre><code>## dose
##   0   5  50 500 
##  20  19  18  17</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" data-line-number="1"><span class="kw">aggregate</span>(weight, <span class="dt">by=</span><span class="kw">list</span>(dose), <span class="dt">FUN=</span>mean)</a></code></pre></div>
<pre><code>##   Group.1        x
## 1       0 32.30850
## 2       5 29.30842
## 3      50 29.86611
## 4     500 29.64647</code></pre>
</div>
<div id="perform-analysis-of-covariance" class="section level5">
<h5>Perform analysis of covariance</h5>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1">litter_fit &lt;-<span class="st"> </span><span class="kw">aov</span>(weight<span class="op">~</span>gesttime<span class="op">+</span>dose)</a>
<a class="sourceLine" id="cb237-2" data-line-number="2"><span class="kw">summary</span>(litter_fit)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## gesttime     1  134.3  134.30   8.049 0.00597 **
## dose         3  137.1   45.71   2.739 0.04988 * 
## Residuals   69 1151.3   16.69                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="calculate-adjusted-group-means" class="section level6">
<h6>Calculate adjusted group means</h6>
<blockquote>
<p>Because you’re using a covariate, you may want to obtain adjusted group means—that is, the group means obtained after partialing out the effects of the covariate. You can use the effect() function in the effects library to calculate adjusted means:</p>
</blockquote>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" data-line-number="1"><span class="kw">library</span>(effects)</a></code></pre></div>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" data-line-number="1"><span class="kw">effect</span>(<span class="st">&#39;dose&#39;</span>, litter_fit)</a></code></pre></div>
<pre><code>## 
##  dose effect
## dose
##        0        5       50      500 
## 32.35367 28.87672 30.56614 29.33460</code></pre>
<blockquote>
<p>In this case, the adjusted means are similar to the unadjusted means produced by the aggregate() function, but this won’t always be the case. The effects package provides a powerful method of obtaining adjusted means for complex research designs and presenting them visually. See the package documentation on CRAN for more details.</p>
</blockquote>
</div>
<div id="multiple-comparisons" class="section level6">
<h6>Multiple comparisons</h6>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" data-line-number="1"><span class="kw">library</span>(multcomp)</a>
<a class="sourceLine" id="cb243-2" data-line-number="2">litter_contrast &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="st">&#39;no drug vs. drug&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">-1</span>, <span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb243-3" data-line-number="3"><span class="kw">summary</span>(<span class="kw">glht</span>(litter_fit, <span class="dt">linfct=</span><span class="kw">mcp</span>(<span class="dt">dose=</span>litter_contrast)))</a></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = weight ~ gesttime + dose)
## 
## Linear Hypotheses:
##                       Estimate Std. Error t value Pr(&gt;|t|)  
## no drug vs. drug == 0    8.284      3.209   2.581    0.012 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<blockquote>
<p>The contrast c(3, -1, -1, -1) specifies a comparison of the first group with the average of the other three. The hypothesis is tested with a t statistic (2.581 in this case), which is significant at the p &lt; .05 level. Therefore, you can conclude that the no-drug group has a higher birth weight than drug conditions. Other contrasts can be added to the rbind() function (see help(glht) for details).</p>
</blockquote>
</div>
</div>
<div id="assumptions" class="section level5">
<h5>Assumptions</h5>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" data-line-number="1"><span class="co"># global validation of linear model assumptions </span></a>
<a class="sourceLine" id="cb245-2" data-line-number="2"><span class="kw">library</span>(gvlma)</a>
<a class="sourceLine" id="cb245-3" data-line-number="3">gvlmalitter &lt;-<span class="st"> </span><span class="kw">gvlma</span>(<span class="kw">lm</span>(weight<span class="op">~</span>gesttime<span class="op">+</span>dose, <span class="dt">data=</span>litter))</a>
<a class="sourceLine" id="cb245-4" data-line-number="4"><span class="kw">summary</span>(gvlmalitter)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ gesttime + dose, data = litter)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.5649  -2.0068   0.1476   3.0755   7.3023 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  -45.366     24.984  -1.816  0.07374 . 
## gesttime       3.519      1.131   3.111  0.00271 **
## dose5         -3.477      1.318  -2.639  0.01027 * 
## dose50        -1.788      1.344  -1.330  0.18780   
## dose500       -3.019      1.352  -2.232  0.02883 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.085 on 69 degrees of freedom
## Multiple R-squared:  0.1908, Adjusted R-squared:  0.1439 
## F-statistic: 4.067 on 4 and 69 DF,  p-value: 0.005105
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = lm(weight ~ gesttime + dose, data = litter)) 
## 
##                        Value p-value                Decision
## Global Stat        8.3233466 0.08043 Assumptions acceptable.
## Skewness           3.0816555 0.07918 Assumptions acceptable.
## Kurtosis           0.0002286 0.98794 Assumptions acceptable.
## Link Function      3.3202398 0.06843 Assumptions acceptable.
## Heteroscedasticity 1.9212226 0.16572 Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" data-line-number="1"><span class="kw">plot</span>(litter_fit)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-61-1.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-61-2.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-61-3.png" width="672" /><img src="code_files/figure-html/unnamed-chunk-61-4.png" width="672" /></p>
<div id="normality-3" class="section level6">
<h6>Normality</h6>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" data-line-number="1"><span class="co"># Shapiro-Wilk W test</span></a>
<a class="sourceLine" id="cb248-2" data-line-number="2"><span class="kw">shapiro.test</span>(<span class="kw">rstandard</span>(litter_fit))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rstandard(litter_fit)
## W = 0.97617, p-value = 0.175</code></pre>
</div>
<div id="equality-of-variances-3" class="section level6">
<h6>Equality of variances</h6>
<p>Note that the Brown-Forsythe test returns a significant result, indicating heterogeneity of residual variances. However, this is for a one-way model without the <code>gesttime</code> covariate. Including the covariate accounts for significant residual variance and satisfies all gvlma assumptions.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb250-2" data-line-number="2"><span class="kw">leveneTest</span>(weight, dose, <span class="dt">data=</span>litter)</a></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median: litter)
##       Df F value  Pr(&gt;F)  
## group  3  3.1788 0.02925 *
##       70                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
</div>
</div>
<div id="manova" class="section level3">
<h3>MANOVA</h3>
<p>MANOVA = Multivariate Analysis of Variance</p>
<div id="manova-example" class="section level4">
<h4>MANOVA example</h4>
<p>Ultrasound data</p>
<div id="import-dataset-7" class="section level5">
<h5>Import dataset</h5>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1">hr &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/manova_hr.csv&#39;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&#39;,&#39;</span>)</a>
<a class="sourceLine" id="cb252-2" data-line-number="2"><span class="kw">attach</span>(hr)</a>
<a class="sourceLine" id="cb252-3" data-line-number="3"><span class="kw">names</span>(hr)</a></code></pre></div>
<pre><code>## [1] &quot;US&quot;   &quot;USC&quot;  &quot;V&quot;    &quot;VC&quot;   &quot;Time&quot;</code></pre>
</div>
<div id="perform-multivariate-anova" class="section level5">
<h5>Perform multivariate ANOVA</h5>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" data-line-number="1">skull.manova1=<span class="kw">manova</span>(<span class="kw">cbind</span>(US,USC,V,VC) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(Time), <span class="dt">data=</span>hr)</a>
<a class="sourceLine" id="cb254-2" data-line-number="2"><span class="kw">summary</span>(skull.manova1)</a></code></pre></div>
<pre><code>##                 Df  Pillai approx F num Df den Df Pr(&gt;F)
## as.factor(Time)  2 0.65326   1.2127      8     20 0.3412
## Residuals       12</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" data-line-number="1"><span class="kw">summary</span>(skull.manova1, <span class="dt">test =</span> <span class="st">&#39;Wilks&#39;</span>)</a></code></pre></div>
<pre><code>##                 Df   Wilks approx F num Df den Df Pr(&gt;F)
## as.factor(Time)  2 0.35085   1.5486      8     18 0.2094
## Residuals       12</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1"><span class="kw">summary</span>(skull.manova1, <span class="dt">test =</span> <span class="st">&#39;Hotelling-Lawley&#39;</span>)</a></code></pre></div>
<pre><code>##                 Df Hotelling-Lawley approx F num Df den Df Pr(&gt;F)
## as.factor(Time)  2           1.8385   1.8385      8     16 0.1427
## Residuals       12</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1"><span class="kw">summary</span>(skull.manova1, <span class="dt">test =</span> <span class="st">&#39;Roy&#39;</span>)</a></code></pre></div>
<pre><code>##                 Df    Roy approx F num Df den Df  Pr(&gt;F)  
## as.factor(Time)  2 1.8321   4.5803      4     10 0.02324 *
## Residuals       12                                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
</div>
<div id="fishers-exact" class="section level3">
<h3>Fisher’s exact</h3>
<div id="fishers-exact-test-arthritis-example" class="section level4">
<h4>Fisher’s exact test arthritis example</h4>
<p>Arthritis data from vcd package</p>
<div id="load-dataset-2" class="section level5">
<h5>Load dataset</h5>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" data-line-number="1"><span class="co"># see R in Action section 7.2 for walkthrough</span></a>
<a class="sourceLine" id="cb262-2" data-line-number="2"><span class="kw">library</span>(vcd)</a></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" data-line-number="1"><span class="kw">summary</span>(Arthritis)</a></code></pre></div>
<pre><code>##        ID          Treatment      Sex          Age          Improved 
##  Min.   : 1.00   Placebo:43   Female:59   Min.   :23.00   None  :42  
##  1st Qu.:21.75   Treated:41   Male  :25   1st Qu.:46.00   Some  :14  
##  Median :42.50                            Median :57.00   Marked:28  
##  Mean   :42.50                            Mean   :53.36              
##  3rd Qu.:63.25                            3rd Qu.:63.00              
##  Max.   :84.00                            Max.   :74.00</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" data-line-number="1"><span class="kw">attach</span>(Arthritis)</a>
<a class="sourceLine" id="cb266-2" data-line-number="2">arthritis_table &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span>Treatment<span class="op">+</span>Improved, <span class="dt">data=</span>Arthritis)</a>
<a class="sourceLine" id="cb266-3" data-line-number="3">arthritis_table</a></code></pre></div>
<pre><code>##          Improved
## Treatment None Some Marked
##   Placebo   29    7      7
##   Treated   13    7     21</code></pre>
</div>
<div id="perform-fishers-exact-test" class="section level5">
<h5>Perform fisher’s exact test</h5>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" data-line-number="1"><span class="kw">fisher.test</span>(arthritis_table)</a></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  arthritis_table
## p-value = 0.001393
## alternative hypothesis: two.sided</code></pre>
</div>
</div>
<div id="fishers-exact-test-prostate-cancer-example" class="section level4">
<h4>Fisher’s exact test prostate cancer example</h4>
<p>Prostate cancer incidence data from TRAMP Tomato Soy paper</p>
<p>Zuniga KE, Clinton SK, Erdman JW. The interactions of dietary tomato powder and soy germ on prostate carcinogenesis in the TRAMP model. Cancer Prev. Res. (2013). DOI: <a href="https://doi.org/10.1158/1940-6207.CAPR-12-0443">10.1158/1940-6207.CAPR-12-0443</a></p>
<div id="create-data-frame" class="section level5">
<h5>Create data frame</h5>
<p>Data also available in fishers_exact_cpr_2013.csv</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" data-line-number="1"><span class="co"># tomato+soy vs control</span></a>
<a class="sourceLine" id="cb270-2" data-line-number="2">diet &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;tomsoy&#39;</span>, <span class="st">&#39;tomsoy&#39;</span>, <span class="st">&#39;control&#39;</span>, <span class="st">&#39;control&#39;</span>)</a>
<a class="sourceLine" id="cb270-3" data-line-number="3">cancer &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;cancer&#39;</span>, <span class="st">&#39;nocancer&#39;</span>, <span class="st">&#39;cancer&#39;</span>, <span class="st">&#39;nocancer&#39;</span>)</a>
<a class="sourceLine" id="cb270-4" data-line-number="4">count &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">29</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb270-5" data-line-number="5">PCaTomatoSoy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(diet, cancer, count)</a>
<a class="sourceLine" id="cb270-6" data-line-number="6">PCaTomatoSoy</a></code></pre></div>
<pre><code>##      diet   cancer count
## 1  tomsoy   cancer    12
## 2  tomsoy nocancer    15
## 3 control   cancer    29
## 4 control nocancer     0</code></pre>
</div>
<div id="create-contingency-table-from-data-frame" class="section level5">
<h5>Create contingency table from data frame</h5>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1">cancertable &lt;-<span class="st"> </span><span class="kw">xtabs</span>(count<span class="op">~</span>diet<span class="op">+</span>cancer, <span class="dt">data=</span>PCaTomatoSoy)</a>
<a class="sourceLine" id="cb272-2" data-line-number="2">cancertable</a></code></pre></div>
<pre><code>##          cancer
## diet      cancer nocancer
##   control     29        0
##   tomsoy      12       15</code></pre>
</div>
<div id="perform-fishers-exact-test-1" class="section level5">
<h5>Perform Fisher’s exact test</h5>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" data-line-number="1"><span class="kw">fisher.test</span>(cancertable)</a></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  cancertable
## p-value = 1.07e-06
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  6.891611      Inf
## sample estimates:
## odds ratio 
##        Inf</code></pre>
</div>
</div>
</div>
<div id="wilcoxon" class="section level3">
<h3>Wilcoxon</h3>
<div id="wilcoxon-test-example" class="section level4">
<h4>Wilcoxon test example</h4>
<p>UScrime dataset from MASS package</p>
<p>See R in Action section 7.5.1 for walkthrough.</p>
<div id="load-dataset-3" class="section level5">
<h5>Load dataset</h5>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" data-line-number="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb276-2" data-line-number="2"><span class="kw">head</span>(UScrime)</a></code></pre></div>
<pre><code>##     M So  Ed Po1 Po2  LF  M.F Pop  NW  U1 U2 GDP Ineq     Prob    Time
## 1 151  1  91  58  56 510  950  33 301 108 41 394  261 0.084602 26.2011
## 2 143  0 113 103  95 583 1012  13 102  96 36 557  194 0.029599 25.2999
## 3 142  1  89  45  44 533  969  18 219  94 33 318  250 0.083401 24.3006
## 4 136  0 121 149 141 577  994 157  80 102 39 673  167 0.015801 29.9012
## 5 141  0 121 109 101 591  985  18  30  91 20 578  174 0.041399 21.2998
## 6 121  0 110 118 115 547  964  25  44  84 29 689  126 0.034201 20.9995
##      y
## 1  791
## 2 1635
## 3  578
## 4 1969
## 5 1234
## 6  682</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" data-line-number="1"><span class="kw">with</span>(UScrime, <span class="kw">by</span>(Prob, So, median))</a></code></pre></div>
<pre><code>## So: 0
## [1] 0.038201
## -------------------------------------------------------- 
## So: 1
## [1] 0.055552</code></pre>
</div>
<div id="perform-wilcoxon-test" class="section level5">
<h5>Perform Wilcoxon test</h5>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" data-line-number="1"><span class="kw">wilcox.test</span>(Prob<span class="op">~</span>So, <span class="dt">data=</span>UScrime, <span class="dt">paired=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb280-2" data-line-number="2">            <span class="dt">alternative=</span><span class="st">&#39;two.sided&#39;</span>, </a>
<a class="sourceLine" id="cb280-3" data-line-number="3">            <span class="dt">var.equal=</span><span class="ot">TRUE</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span></a>
<a class="sourceLine" id="cb280-4" data-line-number="4">            ) </a></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  Prob by So
## W = 81, p-value = 8.488e-05
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="test-assumptions-3" class="section level5">
<h5>Test assumptions</h5>
<div id="equality-of-variances-4" class="section level6">
<h6>Equality of variances</h6>
<p>Note that, although the Wilcoxon rank sum test does not require normality, it does require homogeneity of variances and independence of random samples.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" data-line-number="1"><span class="kw">var.test</span>(Prob<span class="op">~</span>So, <span class="dt">data=</span>UScrime)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  Prob by So
## F = 0.624, num df = 30, denom df = 15, p-value = 0.2646
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.2360299 1.4396653
## sample estimates:
## ratio of variances 
##          0.6240006</code></pre>
</div>
</div>
</div>
</div>
<div id="kruskal-wallis" class="section level3">
<h3>Kruskal-Wallis</h3>
<div id="kruskal-wallis-example" class="section level4">
<h4>Kruskal-Wallis example</h4>
<p>Cardiac magnesium levels from Smith BW J Food Res 2013 (doi: <a href="https://doi.org/10.5539/jfr.v2n1p168">10.5539/jfr.v2n1p168</a>).</p>
<div id="import-dataset-8" class="section level5">
<h5>Import dataset</h5>
<ul>
<li>In RStudio, tools-&gt;import dataset can also be used.</li>
<li>Dataset is attached so variables can be named without reference to the original dataset.</li>
</ul>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" data-line-number="1">cardiacMg &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;data/kruskal_wallis_jfr2013_mg_cardiac.csv&#39;</span>,</a>
<a class="sourceLine" id="cb284-2" data-line-number="2">                        <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span></a>
<a class="sourceLine" id="cb284-3" data-line-number="3">                        )</a>
<a class="sourceLine" id="cb284-4" data-line-number="4"><span class="kw">attach</span>(cardiacMg)</a></code></pre></div>
<pre><code>## The following object is masked _by_ .GlobalEnv:
## 
##     diet</code></pre>
<pre><code>## The following object is masked from adipose_weights:
## 
##     diet</code></pre>
<pre><code>## The following object is masked from feedtc:
## 
##     diet</code></pre>
<pre><code>## The following object is masked from jfr2013_atheroma:
## 
##     diet</code></pre>
</div>
<div id="perform-kruskal-wallis-test" class="section level5">
<h5>Perform Kruskal-Wallis test</h5>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" data-line-number="1"><span class="kw">kruskal.test</span>(mg<span class="op">~</span>diet, <span class="dt">data =</span> cardiacMg) </a></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  mg by diet
## Kruskal-Wallis chi-squared = 6.7757, df = 2, p-value = 0.03378</code></pre>
<div id="multiple-comparisons-1" class="section level6">
<h6>Multiple comparisons</h6>
<ul>
<li>Pairwise Wilcoxon testing with experiment-wide error correction</li>
<li>Nemenyi test (pairwise test for multiple comparisons of mean rank sums). Not corrected for multiple comparisons.</li>
<li>Dunnett non-parametric multiple comparisons</li>
</ul>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" data-line-number="1"><span class="co"># Pairwise Wilcoxon</span></a>
<a class="sourceLine" id="cb291-2" data-line-number="2"><span class="kw">pairwise.wilcox.test</span>(cardiacMg<span class="op">$</span>mg, cardiacMg<span class="op">$</span>diet, <span class="dt">p.adjust.method=</span><span class="st">&#39;holm&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot
## compute exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot
## compute exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot
## compute exact p-value with ties</code></pre>
<pre><code>## 
##  Pairwise comparisons using Wilcoxon rank sum test 
## 
## data:  cardiacMg$mg and cardiacMg$diet 
## 
##      0.1   0.4  
## 0.4  0.885 -    
## chow 0.063 0.048
## 
## P value adjustment method: holm</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" data-line-number="1"><span class="co"># Nemenyi</span></a>
<a class="sourceLine" id="cb294-2" data-line-number="2"><span class="kw">library</span>(PMCMRplus)</a>
<a class="sourceLine" id="cb294-3" data-line-number="3"><span class="kw">kwAllPairsNemenyiTest</span>(cardiacMg<span class="op">$</span>mg, cardiacMg<span class="op">$</span>diet, <span class="dt">method=</span><span class="st">&#39;Tukey&#39;</span>)</a></code></pre></div>
<pre><code>## Warning in kwAllPairsNemenyiTest.default(cardiacMg$mg, cardiacMg$diet,
## method = &quot;Tukey&quot;): Ties are present, p-values are not corrected.</code></pre>
<pre><code>## 
##  Pairwise comparisons using Tukey-Kramer-Nemenyi all-pairs test with Tukey-Dist approximation</code></pre>
<pre><code>## data: cardiacMg$mg and cardiacMg$diet</code></pre>
<pre><code>##      0.1   0.4  
## 0.4  0.992 -    
## chow 0.039 0.044</code></pre>
<pre><code>## 
## P value adjustment method: single-step</code></pre>
<pre><code>## alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1"><span class="co"># Dunnett</span></a>
<a class="sourceLine" id="cb301-2" data-line-number="2"><span class="kw">library</span>(nparcomp)</a>
<a class="sourceLine" id="cb301-3" data-line-number="3"><span class="kw">nparcomp</span>(mg<span class="op">~</span>diet, <span class="dt">data =</span> cardiacMg, <span class="dt">type=</span><span class="st">&#39;Dunnett&#39;</span>, <span class="dt">control=</span><span class="st">&#39;chow&#39;</span>) </a></code></pre></div>
<pre><code>## 
##  #------Nonparametric Multiple Comparisons for relative contrast effects-----# 
##  
##  - Alternative Hypothesis:  True relative contrast effect p is less or equal than 1/2 
##  - Type of Contrast : Dunnett 
##  - Confidence level: 95 % 
##  - Method = Logit - Transformation 
##  - Estimation Method: Pairwise rankings 
##  
##  #---------------------------Interpretation----------------------------------# 
##  p(a,b) &gt; 1/2 : b tends to be larger than a 
##  #---------------------------------------------------------------------------# 
## </code></pre>
<pre><code>## $Data.Info
##   Sample Size
## 1    0.1    8
## 2    0.4    9
## 3   chow    3
## 
## $Contrast
##            0.1 0.4 chow
## 0.1 - chow   1   0   -1
## 0.4 - chow   0   1   -1
## 
## $Analysis
##        Comparison Estimator Lower Upper Statistic    p.Value
## 1 p( chow , 0.1 )     0.042 0.002 0.541 -2.124749 0.06608568
## 2 p( chow , 0.4 )     0.001 0.000 0.005 -9.757859 0.00000000
## 
## $Overall
##   Quantile p.Value
## 1 2.236422       0
## 
## $input
## $input$formula
## mg ~ diet
## 
## $input$data
##    diet    mg
## 1  chow 0.199
## 2  chow 0.363
## 3  chow 0.363
## 4   0.1 0.321
## 5   0.1 0.141
## 6   0.1 0.144
## 7   0.1 0.145
## 8   0.1 0.140
## 9   0.1 0.157
## 10  0.1 0.137
## 11  0.1 0.144
## 12  0.4 0.140
## 13  0.4 0.160
## 14  0.4 0.138
## 15  0.4 0.145
## 16  0.4 0.150
## 17  0.4 0.146
## 18  0.4 0.144
## 19  0.4 0.149
## 20  0.4 0.139
## 
## $input$type
## [1] &quot;Dunnett&quot;
## 
## $input$conf.level
## [1] 0.95
## 
## $input$alternative
## [1] &quot;two.sided&quot; &quot;less&quot;      &quot;greater&quot;  
## 
## $input$asy.method
## [1] &quot;logit&quot;  &quot;probit&quot; &quot;normal&quot; &quot;mult.t&quot;
## 
## $input$plot.simci
## [1] FALSE
## 
## $input$control
## [1] &quot;chow&quot;
## 
## $input$info
## [1] TRUE
## 
## $input$rounds
## [1] 3
## 
## $input$contrast.matrix
## NULL
## 
## $input$correlation
## [1] FALSE
## 
## $input$weight.matrix
## [1] FALSE
## 
## 
## $text.Output
## [1] &quot;True relative contrast effect p is less or equal than 1/2&quot;
## 
## $connames
## [1] &quot;p( chow , 0.1 )&quot; &quot;p( chow , 0.4 )&quot;
## 
## $AsyMethod
## [1] &quot;Logit - Transformation&quot;
## 
## attr(,&quot;class&quot;)
## [1] &quot;nparcomp&quot;</code></pre>
</div>
</div>
<div id="test-assumptions-4" class="section level5">
<h5>Test assumptions</h5>
<div id="normality-4" class="section level6">
<h6>Normality</h6>
<ul>
<li>The RColorBrewer package is loaded for additional colors, and a palette is added to R. Use brackets after vector name for specific colors when creating plots (for example: <code>col=set1[4:14]</code>).</li>
<li>Legend can also be manually positioned with xy coordinates (numbers from 0,0 at bottom left of plot to 1,1 at top right)</li>
<li>As demonstrated by the tests below, these data fail the assumption of normality, and are not amenable to transformation, hence the use of non-parametric testing.</li>
</ul>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" data-line-number="1"><span class="co"># Shapiro-Wilk W test</span></a>
<a class="sourceLine" id="cb304-2" data-line-number="2"><span class="kw">shapiro.test</span>(cardiacMg<span class="op">$</span>mg)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  cardiacMg$mg
## W = 0.55747, p-value = 1.101e-06</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" data-line-number="1"><span class="co"># Normal Quantile-Quantile Plot</span></a>
<a class="sourceLine" id="cb306-2" data-line-number="2"><span class="co"># Set graphical parameters</span></a>
<a class="sourceLine" id="cb306-3" data-line-number="3"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="dv">3</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>, <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb306-4" data-line-number="4">    <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">lend =</span> <span class="dv">0</span>, <span class="dt">ljoin =</span> <span class="dv">0</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb306-5" data-line-number="5">    )</a>
<a class="sourceLine" id="cb306-6" data-line-number="6"></a>
<a class="sourceLine" id="cb306-7" data-line-number="7"><span class="co"># Load RColorBrewer and set palette</span></a>
<a class="sourceLine" id="cb306-8" data-line-number="8"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb306-9" data-line-number="9">set1 &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Set1&#39;</span>)</a>
<a class="sourceLine" id="cb306-10" data-line-number="10"></a>
<a class="sourceLine" id="cb306-11" data-line-number="11"><span class="co"># Create vector for categories</span></a>
<a class="sourceLine" id="cb306-12" data-line-number="12">categories &lt;-<span class="st"> </span><span class="kw">factor</span>(cardiacMg<span class="op">$</span>diet)</a>
<a class="sourceLine" id="cb306-13" data-line-number="13"></a>
<a class="sourceLine" id="cb306-14" data-line-number="14"><span class="co"># Create plot</span></a>
<a class="sourceLine" id="cb306-15" data-line-number="15"><span class="kw">qqnorm</span>(mg, <span class="dt">ylab=</span><span class="st">&#39;Mg, mg/g&#39;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col=</span>set1[categories], <span class="dt">lwd=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb306-16" data-line-number="16"><span class="co"># Add normal line</span></a>
<a class="sourceLine" id="cb306-17" data-line-number="17"><span class="kw">qqline</span>(cardiacMg<span class="op">$</span>mg, <span class="dt">lwd=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb306-18" data-line-number="18"><span class="co"># Add border to complete axes</span></a>
<a class="sourceLine" id="cb306-19" data-line-number="19"><span class="kw">box</span>(<span class="dt">which =</span> <span class="st">&#39;plot&#39;</span>, <span class="dt">bty =</span> <span class="st">&#39;o&#39;</span>, <span class="dt">lwd=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb306-20" data-line-number="20"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>)  <span class="co"># x axis</span></a>
<a class="sourceLine" id="cb306-21" data-line-number="21"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>)  <span class="co"># y axis</span></a>
<a class="sourceLine" id="cb306-22" data-line-number="22"><span class="co"># Add legend</span></a>
<a class="sourceLine" id="cb306-23" data-line-number="23"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="dt">legend=</span><span class="kw">levels</span>(categories), </a>
<a class="sourceLine" id="cb306-24" data-line-number="24">       <span class="dt">box.lwd=</span><span class="dv">3</span>, <span class="dt">pch=</span><span class="fl">1.5</span>, <span class="dt">cex=</span><span class="fl">1.75</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>, <span class="dt">pt.lwd=</span><span class="dv">4</span>, <span class="dt">col=</span>set1</a>
<a class="sourceLine" id="cb306-25" data-line-number="25">       )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
<div id="equality-of-variances-5" class="section level6">
<h6>Equality of variances</h6>
<ul>
<li>This is a brown-forsythe test that evaluates deviations from group medians, and thus is robust to violations of normality.</li>
<li>Fligner test included for comparison.</li>
</ul>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" data-line-number="1"><span class="kw">library</span>(lawstat)</a></code></pre></div>
<pre><code>## Loading required package: Kendall</code></pre>
<pre><code>## Loading required package: VGAM</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## Loading required package: splines</code></pre>
<pre><code>## 
## Attaching package: &#39;VGAM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<pre><code>## 
## Attaching package: &#39;lawstat&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     levene.test</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1"><span class="kw">levene.test</span>(cardiacMg<span class="op">$</span>mg, cardiacMg<span class="op">$</span>diet)</a></code></pre></div>
<pre><code>## 
##  modified robust Brown-Forsythe Levene-type test based on the
##  absolute deviations from the median
## 
## data:  cardiacMg$mg
## Test Statistic = 1.1301, p-value = 0.3461</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1"><span class="co"># Fligner test</span></a>
<a class="sourceLine" id="cb318-2" data-line-number="2"><span class="kw">fligner.test</span>(cardiacMg<span class="op">$</span>mg<span class="op">~</span>cardiacMg<span class="op">$</span>diet)</a></code></pre></div>
<pre><code>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  cardiacMg$mg by cardiacMg$diet
## Fligner-Killeen:med chi-squared = 0.11837, df = 2, p-value =
## 0.9425</code></pre>
</div>
</div>
<div id="generate-boxplot" class="section level5">
<h5>Generate boxplot</h5>
<ul>
<li><strong>Parameters (<code>par</code>):</strong> Graphical parameters need to be set again because of code chunk separation in RMarkdown. Normally they would only be set once per R session.</li>
<li><strong>X axis:</strong> The default axes will usually detect categorical data and label axes accordingly, but categories will need to be specified for axes created separately. It is easiest to create a separate vector with the categories, and then reference it when creating the plot. Labels can also be specified with <code>labels=c('group1', 'group2')</code>.</li>
<li><strong>Y axis:</strong> Note that it does not always start at zero, but encompasses the data range with some padding.</li>
</ul>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" data-line-number="1"><span class="co"># Set graphical parameters</span></a>
<a class="sourceLine" id="cb320-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="dv">3</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>, <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb320-3" data-line-number="3">    <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">lend =</span> <span class="dv">0</span>, <span class="dt">ljoin =</span> <span class="dv">0</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb320-4" data-line-number="4">    <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb320-5" data-line-number="5">    )</a>
<a class="sourceLine" id="cb320-6" data-line-number="6"></a>
<a class="sourceLine" id="cb320-7" data-line-number="7"><span class="co"># Create boxplot</span></a>
<a class="sourceLine" id="cb320-8" data-line-number="8"><span class="kw">boxplot</span>(cardiacMg<span class="op">$</span>mg<span class="op">~</span>cardiacMg<span class="op">$</span>diet, <span class="dt">main=</span><span class="st">&#39;Cardiac mg&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;diet&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Mg, mg/g&#39;</span>,</a>
<a class="sourceLine" id="cb320-9" data-line-number="9">        <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">lwd=</span><span class="dv">4</span>, <span class="dt">medlwd=</span><span class="dv">7</span>, <span class="dt">outlwd=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">col=</span>set1</a>
<a class="sourceLine" id="cb320-10" data-line-number="10">        )</a>
<a class="sourceLine" id="cb320-11" data-line-number="11"></a>
<a class="sourceLine" id="cb320-12" data-line-number="12"><span class="co"># Add border to complete axes</span></a>
<a class="sourceLine" id="cb320-13" data-line-number="13"><span class="kw">box</span>(<span class="dt">which =</span> <span class="st">&#39;plot&#39;</span>, <span class="dt">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">lwd =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb320-14" data-line-number="14"></a>
<a class="sourceLine" id="cb320-15" data-line-number="15"><span class="co"># Create vector with means of each group</span></a>
<a class="sourceLine" id="cb320-16" data-line-number="16">means &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mg<span class="op">~</span>diet, <span class="dt">data=</span>cardiacMg, mean)</a>
<a class="sourceLine" id="cb320-17" data-line-number="17"><span class="co"># Add points for group means to boxplot</span></a>
<a class="sourceLine" id="cb320-18" data-line-number="18"><span class="kw">points</span>(means<span class="op">$</span>mg, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="dv">23</span>, <span class="dt">bg=</span><span class="dv">0</span>, <span class="dt">lwd=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb320-19" data-line-number="19"></a>
<a class="sourceLine" id="cb320-20" data-line-number="20"><span class="co"># X axis</span></a>
<a class="sourceLine" id="cb320-21" data-line-number="21"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>, </a>
<a class="sourceLine" id="cb320-22" data-line-number="22">     <span class="dt">labels=</span><span class="kw">levels</span>(categories), <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb320-23" data-line-number="23">     )</a>
<a class="sourceLine" id="cb320-24" data-line-number="24"></a>
<a class="sourceLine" id="cb320-25" data-line-number="25"><span class="co"># Y axis</span></a>
<a class="sourceLine" id="cb320-26" data-line-number="26"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">5</span>, <span class="dt">tcl =</span> <span class="fl">-0.5</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="plots" class="section level2">
<h2>Plots</h2>
<div id="general-examples" class="section level3">
<h3>General examples</h3>
<div id="ggplot2-qplot-example" class="section level4">
<h4>ggplot2 qplot example</h4>
<p>Example from ggplot2 documentation p. 135</p>
<div id="intro-1" class="section level5">
<h5>Intro</h5>
<p>This file demonstrates some of the capabilities in the ggplot2 package. The mtcars dataset is included with R. The beginning of the dataset is shown with <code>head(mtcars)</code> to verify.</p>
</div>
<div id="import-data" class="section level5">
<h5>Import data</h5>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb321-2" data-line-number="2"><span class="kw">head</span>(mtcars)</a></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div id="plot-data" class="section level5">
<h5>Plot data</h5>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" data-line-number="1"><span class="co"># from ggplot2 documentation p.135</span></a>
<a class="sourceLine" id="cb323-2" data-line-number="2"><span class="co"># Use data from data.frame</span></a>
<a class="sourceLine" id="cb323-3" data-line-number="3"><span class="kw">qplot</span>(mpg, wt, <span class="dt">data=</span>mtcars)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1"><span class="kw">qplot</span>(mpg, wt, <span class="dt">data=</span>mtcars, <span class="dt">colour=</span>cyl)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-2.png" width="672" /></p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" data-line-number="1"><span class="kw">qplot</span>(mpg, wt, <span class="dt">data=</span>mtcars, <span class="dt">size=</span>cyl)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-3.png" width="672" /></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" data-line-number="1"><span class="kw">qplot</span>(mpg, wt, <span class="dt">data=</span>mtcars, <span class="dt">facets=</span>vs <span class="op">~</span><span class="st"> </span>am)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-4.png" width="672" /></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" data-line-number="1"><span class="co"># It will use data from local environment</span></a>
<a class="sourceLine" id="cb327-2" data-line-number="2">hp &lt;-<span class="st"> </span>mtcars<span class="op">$</span>hp</a>
<a class="sourceLine" id="cb327-3" data-line-number="3">wt &lt;-<span class="st"> </span>mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb327-4" data-line-number="4">cyl &lt;-<span class="st"> </span>mtcars<span class="op">$</span>cyl</a>
<a class="sourceLine" id="cb327-5" data-line-number="5">vs &lt;-<span class="st"> </span>mtcars<span class="op">$</span>vs</a>
<a class="sourceLine" id="cb327-6" data-line-number="6">am &lt;-<span class="st"> </span>mtcars<span class="op">$</span>am</a>
<a class="sourceLine" id="cb327-7" data-line-number="7"><span class="kw">qplot</span>(hp, wt)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-5.png" width="672" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" data-line-number="1"><span class="kw">qplot</span>(hp, wt, <span class="dt">colour=</span>cyl)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-6.png" width="672" /></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" data-line-number="1"><span class="kw">qplot</span>(hp, wt, <span class="dt">size=</span>cyl)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-7.png" width="672" /></p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1"><span class="kw">qplot</span>(hp, wt, <span class="dt">facets=</span>vs <span class="op">~</span><span class="st"> </span>am)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-8.png" width="672" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" data-line-number="1"><span class="kw">qplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dt">colour =</span> <span class="kw">runif</span>(<span class="dv">10</span>))</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-9.png" width="672" /></p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" data-line-number="1"><span class="kw">qplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, letters[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-10.png" width="672" /></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" data-line-number="1">mod &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb333-2" data-line-number="2"><span class="kw">qplot</span>(<span class="kw">resid</span>(mod), <span class="kw">fitted</span>(mod))</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-11.png" width="672" /></p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" data-line-number="1"><span class="kw">qplot</span>(<span class="kw">resid</span>(mod), <span class="kw">fitted</span>(mod), <span class="dt">facets =</span> . <span class="op">~</span><span class="st"> </span>vs)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-12.png" width="672" /></p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb335-2" data-line-number="2">  a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb335-3" data-line-number="3">  b &lt;-<span class="st"> </span>a <span class="op">^</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb335-4" data-line-number="4">  <span class="kw">qplot</span>(a, b) }</a>
<a class="sourceLine" id="cb335-5" data-line-number="5"><span class="kw">f</span>()</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-13.png" width="672" /></p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" data-line-number="1"><span class="co"># qplot will attempt to guess what geom you want depending on the input</span></a>
<a class="sourceLine" id="cb336-2" data-line-number="2"><span class="co"># both x and y supplied = scatterplot</span></a>
<a class="sourceLine" id="cb336-3" data-line-number="3"><span class="kw">qplot</span>(mpg, wt, <span class="dt">data =</span> mtcars)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-14.png" width="672" /></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" data-line-number="1"><span class="co"># just x supplied = histogram</span></a>
<a class="sourceLine" id="cb337-2" data-line-number="2"><span class="kw">qplot</span>(mpg, <span class="dt">data =</span> mtcars)</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-81-15.png" width="672" /></p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb339-1" data-line-number="1"><span class="co"># just y supplied = scatterplot, with x = seq_along(y)</span></a>
<a class="sourceLine" id="cb339-2" data-line-number="2"><span class="kw">qplot</span>(<span class="dt">y =</span> mpg, <span class="dt">data =</span> mtcars)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-16.png" width="672" /></p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" data-line-number="1"><span class="co"># Use different geoms</span></a>
<a class="sourceLine" id="cb340-2" data-line-number="2"><span class="kw">qplot</span>(mpg, wt, <span class="dt">data =</span> mtcars, <span class="dt">geom=</span><span class="st">&#39;path&#39;</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-17.png" width="672" /></p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" data-line-number="1"><span class="kw">qplot</span>(<span class="kw">factor</span>(cyl), wt, <span class="dt">data =</span> mtcars, <span class="dt">geom=</span><span class="kw">c</span>(<span class="st">&#39;boxplot&#39;</span>, <span class="st">&#39;jitter&#39;</span>))</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-81-18.png" width="672" /></p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" data-line-number="1"><span class="kw">qplot</span>(mpg, <span class="dt">data =</span> mtcars, <span class="dt">geom =</span> <span class="st">&#39;dotplot&#39;</span>)</a></code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="code_files/figure-html/unnamed-chunk-81-19.png" width="672" /></p>
</div>
</div>
<div id="creating-rotated-axis-labels-in-r" class="section level4">
<h4>Creating rotated axis labels in R</h4>
<p>7.27 <a href="http://www.hep.by/gnu/r-patched/r-faq/R-FAQ_78.html">How can I create rotated axis labels?</a></p>
<div id="intro-2" class="section level5">
<h5>Intro</h5>
<p>To rotate axis labels (using base graphics), you need to use text(), rather than mtext(), as the latter does not support par(‘srt’).</p>
</div>
<div id="example-plot" class="section level5">
<h5>Example plot</h5>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" data-line-number="1"><span class="co"># Increase bottom margin to make room for rotated labels</span></a>
<a class="sourceLine" id="cb344-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb344-3" data-line-number="3"><span class="co"># Create plot with no x axis and no x axis label</span></a>
<a class="sourceLine" id="cb344-4" data-line-number="4"><span class="kw">plot</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">8</span>, <span class="dt">xaxt =</span> <span class="st">&#39;n&#39;</span>,  <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb344-5" data-line-number="5"><span class="co"># Set up x axis with tick marks alone</span></a>
<a class="sourceLine" id="cb344-6" data-line-number="6"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb344-7" data-line-number="7"><span class="co"># Create some text labels</span></a>
<a class="sourceLine" id="cb344-8" data-line-number="8">labels &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;Label&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">sep =</span> <span class="st">&#39; &#39;</span>)</a>
<a class="sourceLine" id="cb344-9" data-line-number="9"><span class="co"># Plot x axis labels at default tick marks</span></a>
<a class="sourceLine" id="cb344-10" data-line-number="10"><span class="kw">text</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="kw">par</span>(<span class="st">&#39;usr&#39;</span>)[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>, <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb344-11" data-line-number="11">     <span class="dt">labels =</span> labels, <span class="dt">xpd =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb344-12" data-line-number="12">     )</a>
<a class="sourceLine" id="cb344-13" data-line-number="13"><span class="co"># Plot x axis label at line 6 (of 7)</span></a>
<a class="sourceLine" id="cb344-14" data-line-number="14"><span class="kw">mtext</span>(<span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&#39;X Axis Label&#39;</span>, <span class="dt">line =</span> <span class="dv">6</span>)</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
</div>
<div id="comments" class="section level5">
<h5>Comments</h5>
<ul>
<li>When plotting the x axis labels, we use srt = 45 for text rotation angle, adj = 1 to place the right end of text at the tick marks, and xpd = TRUE to allow for text outside the plot region. You can adjust the value of the 0.25 offset as required to move the axis labels up or down relative to the x axis. See ?par for more information.</li>
<li>Also see Figure 1 and associated code in Paul Murrell (2003), ‘Integrating grid Graphics Output with Base Graphics Output’, R News, 3/2, 7-12.</li>
</ul>
</div>
</div>
</div>
<div id="volcano-plots" class="section level3">
<h3>Volcano plots</h3>
<div id="getting-genetics-done-example" class="section level4">
<h4>Getting Genetics Done example</h4>
<p>Volcano plot example from <a href="http://www.gettinggeneticsdone.com/2014/05/r-volcano-plots-to-visualize-rnaseq-microarray.html">Getting Genetics Done</a>.</p>
<div id="import-dataset-from-github" class="section level5">
<h5>Import dataset from GitHub</h5>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb345-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;https://gist.githubusercontent.com/stephenturner/806e31fce55a8b7175af/raw/9479acb809fae09aa50ea7df54a1199b3f1ffa11/results.txt&#39;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb345-2" data-line-number="2"><span class="kw">head</span>(res)</a></code></pre></div>
<pre><code>##      Gene log2FoldChange    pvalue      padj
## 1    DOK6         0.5100 1.861e-08 0.0003053
## 2    TBX5        -2.1290 5.655e-08 0.0004191
## 3 SLC32A1         0.9003 7.664e-08 0.0004191
## 4  IFITM1        -1.6870 3.735e-06 0.0068090
## 5   NUP93         0.3659 3.373e-06 0.0068090
## 6 EMILIN2         1.5340 2.976e-06 0.0068090</code></pre>
</div>
<div id="make-a-basic-volcano-plot" class="section level5">
<h5>Make a basic volcano plot</h5>
<p>The <code>-log10(pvalue)</code> is used so p values can be plotted as whole numbers. Note that I was not able to separate each section into different R markdown code chunks. I needed the generation of points to be continuous with generation of the original plot.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb347-1" data-line-number="1"><span class="kw">with</span>(res, </a>
<a class="sourceLine" id="cb347-2" data-line-number="2">     <span class="kw">plot</span>(log2FoldChange, <span class="op">-</span><span class="kw">log10</span>(pvalue), <span class="dt">pch=</span><span class="dv">20</span>, </a>
<a class="sourceLine" id="cb347-3" data-line-number="3">          <span class="dt">main=</span><span class="st">&#39;Volcano plot&#39;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb347-4" data-line-number="4">          )</a>
<a class="sourceLine" id="cb347-5" data-line-number="5">     )</a>
<a class="sourceLine" id="cb347-6" data-line-number="6"><span class="co"># Add colored points:</span></a>
<a class="sourceLine" id="cb347-7" data-line-number="7"><span class="co"># red if padj&lt;0.05</span></a>
<a class="sourceLine" id="cb347-8" data-line-number="8"><span class="co"># orange if log2FC&gt;1</span></a>
<a class="sourceLine" id="cb347-9" data-line-number="9"><span class="co"># green if both</span></a>
<a class="sourceLine" id="cb347-10" data-line-number="10"><span class="kw">with</span>(<span class="kw">subset</span>(res, padj<span class="op">&lt;</span>.<span class="dv">05</span> ),</a>
<a class="sourceLine" id="cb347-11" data-line-number="11">     <span class="kw">points</span>(log2FoldChange, <span class="op">-</span><span class="kw">log10</span>(pvalue), </a>
<a class="sourceLine" id="cb347-12" data-line-number="12">            <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb347-13" data-line-number="13">     )</a>
<a class="sourceLine" id="cb347-14" data-line-number="14"><span class="kw">with</span>(<span class="kw">subset</span>(res, <span class="kw">abs</span>(log2FoldChange)<span class="op">&gt;</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb347-15" data-line-number="15">     <span class="kw">points</span>(log2FoldChange, <span class="op">-</span><span class="kw">log10</span>(pvalue), </a>
<a class="sourceLine" id="cb347-16" data-line-number="16">            <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;orange&#39;</span>)</a>
<a class="sourceLine" id="cb347-17" data-line-number="17">     )</a>
<a class="sourceLine" id="cb347-18" data-line-number="18"><span class="kw">with</span>(<span class="kw">subset</span>(res, padj<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2FoldChange)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb347-19" data-line-number="19">     <span class="kw">points</span>(log2FoldChange, <span class="op">-</span><span class="kw">log10</span>(pvalue), </a>
<a class="sourceLine" id="cb347-20" data-line-number="20">            <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb347-21" data-line-number="21">     )</a>
<a class="sourceLine" id="cb347-22" data-line-number="22"></a>
<a class="sourceLine" id="cb347-23" data-line-number="23"><span class="co"># Label points with the textxy function from the calibrate package</span></a>
<a class="sourceLine" id="cb347-24" data-line-number="24"><span class="kw">library</span>(calibrate)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;calibrate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:VGAM&#39;:
## 
##     calibrate</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" data-line-number="1"><span class="kw">with</span>(<span class="kw">subset</span>(res, padj<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2FoldChange)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb350-2" data-line-number="2">     <span class="kw">textxy</span>(log2FoldChange, <span class="op">-</span><span class="kw">log10</span>(pvalue), <span class="dt">labs=</span>Gene, <span class="dt">cex=</span>.<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb350-3" data-line-number="3">     )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</div>
</div>
<div id="nrf1-proteomics-volcano-plot" class="section level4">
<h4>Nrf1 proteomics volcano plot</h4>
<p>Experimental data example from <a href="https://github.com/br3ndonland/R-proteomics-Nrf1">Nrf1 proteomics project</a>. The goal of this experiment was to identify a molecular complex associated with Nrf1, a protein molecule our research group was studying. Complement C1q proteins were identified as potentially interacting with Nrf1.</p>
<div id="import-data-1" class="section level5">
<h5>Import data</h5>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" data-line-number="1">proteomics_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;https://raw.githubusercontent.com/br3ndonland/R-proteomics-Nrf1/master/data/R-proteomics-Nrf1.csv&#39;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&#39;,&#39;</span>)</a>
<a class="sourceLine" id="cb351-2" data-line-number="2"><span class="kw">attach</span>(proteomics_data)</a>
<a class="sourceLine" id="cb351-3" data-line-number="3"><span class="kw">head</span>(proteomics_data)</a></code></pre></div>
<pre><code>##       Gene log2_FC_HAchol_HAchow log2_FC_HAchow_lacZ     pvalue pvaluechow
## 1 Serpinb5            0.09538888          -1.3634997 0.74081917 0.39977101
## 2      Sfn            0.41354494          -1.0428302 0.40347276 0.20906780
## 3     Eno1            0.63929006          -0.6662456 0.22617602 0.32692726
## 4     C1qc            1.25725953           0.0891710 0.01419030 0.86011207
## 5     C1qa            1.16884182           0.0303050 0.01219113 0.95321354
## 6    Gstm1            0.19700734          -0.8650671 0.65225515 0.09657287
##   log2_FC_HAbort_HAchow pvaluebort
## 1             1.7303640 0.31471162
## 2             2.5999482 0.01377441
## 3             0.8034121 0.06946092
## 4             0.0946041 0.84034899
## 5             0.1015774 0.80231428
## 6             0.4450431 0.21202782</code></pre>
</div>
<div id="generate-plots-7" class="section level5">
<h5>Generate plots</h5>
<ul>
<li>Each point is a protein.
<ul>
<li>Red if p&lt;0.05 for the comparison shown</li>
<li>Orange if [log2 fold change]&gt;1</li>
<li>Green if both</li>
</ul></li>
<li>log2 transformation is used to normalize positive and negative fold changes.</li>
<li>-log10(pvalue) is used so p values can be plotted as whole numbers.</li>
</ul>
<div id="ha-cholesterol-plot" class="section level6">
<h6>HA cholesterol plot</h6>
<p>This plot compares chow-fed mice with mice fed the Paigen diet to promote accumulation of cholesterol in the liver, and demonstrates the increased abundance of Complement C1qA, C1qB, and C1qC, in mice fed the Paigen diet.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" data-line-number="1"><span class="co"># bold axis titles</span></a>
<a class="sourceLine" id="cb353-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">font.lab=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb353-3" data-line-number="3"></a>
<a class="sourceLine" id="cb353-4" data-line-number="4"><span class="co"># create plot</span></a>
<a class="sourceLine" id="cb353-5" data-line-number="5"><span class="kw">with</span>(proteomics_data,</a>
<a class="sourceLine" id="cb353-6" data-line-number="6">     <span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb353-7" data-line-number="7">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb353-8" data-line-number="8">       <span class="op">-</span><span class="kw">log10</span>(pvalue),</a>
<a class="sourceLine" id="cb353-9" data-line-number="9">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb353-10" data-line-number="10">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb353-11" data-line-number="11">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb353-12" data-line-number="12">       <span class="dt">yaxp=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb353-13" data-line-number="13">       <span class="dt">main=</span><span class="st">&#39;Cholesterol-induced Nrf1 interacting proteins&#39;</span>,</a>
<a class="sourceLine" id="cb353-14" data-line-number="14">       <span class="dt">xlab=</span><span class="st">&#39;log2(FC HA chol/HA chow)&#39;</span>,</a>
<a class="sourceLine" id="cb353-15" data-line-number="15">       <span class="dt">ylab=</span><span class="st">&#39;-log10(pvalue HA chol vs HA chow)&#39;</span>,</a>
<a class="sourceLine" id="cb353-16" data-line-number="16">       <span class="dt">family=</span><span class="st">&#39;Raleway&#39;</span></a>
<a class="sourceLine" id="cb353-17" data-line-number="17">       )</a>
<a class="sourceLine" id="cb353-18" data-line-number="18">     )</a>
<a class="sourceLine" id="cb353-19" data-line-number="19"></a>
<a class="sourceLine" id="cb353-20" data-line-number="20"><span class="co"># Add colored points: </span></a>
<a class="sourceLine" id="cb353-21" data-line-number="21"><span class="co"># red if pvalue&lt;0.05, orange if [log2FC]&gt;1, green if both)</span></a>
<a class="sourceLine" id="cb353-22" data-line-number="22"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvalue<span class="op">&lt;</span>.<span class="dv">05</span>),</a>
<a class="sourceLine" id="cb353-23" data-line-number="23">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb353-24" data-line-number="24">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb353-25" data-line-number="25">       <span class="op">-</span><span class="kw">log10</span>(pvalue),</a>
<a class="sourceLine" id="cb353-26" data-line-number="26">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb353-27" data-line-number="27">       <span class="dt">col=</span><span class="st">&#39;red&#39;</span></a>
<a class="sourceLine" id="cb353-28" data-line-number="28">       )</a>
<a class="sourceLine" id="cb353-29" data-line-number="29">     )</a>
<a class="sourceLine" id="cb353-30" data-line-number="30"></a>
<a class="sourceLine" id="cb353-31" data-line-number="31"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, <span class="kw">abs</span>(log2_FC_HAchol_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb353-32" data-line-number="32">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb353-33" data-line-number="33">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb353-34" data-line-number="34">       <span class="op">-</span><span class="kw">log10</span>(pvalue),</a>
<a class="sourceLine" id="cb353-35" data-line-number="35">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb353-36" data-line-number="36">       <span class="dt">col=</span><span class="st">&#39;orange&#39;</span></a>
<a class="sourceLine" id="cb353-37" data-line-number="37">       )</a>
<a class="sourceLine" id="cb353-38" data-line-number="38">     )</a>
<a class="sourceLine" id="cb353-39" data-line-number="39"></a>
<a class="sourceLine" id="cb353-40" data-line-number="40"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvalue<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAchol_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb353-41" data-line-number="41">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb353-42" data-line-number="42">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb353-43" data-line-number="43">       <span class="op">-</span><span class="kw">log10</span>(pvalue),</a>
<a class="sourceLine" id="cb353-44" data-line-number="44">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb353-45" data-line-number="45">       <span class="dt">col=</span><span class="st">&#39;green&#39;</span></a>
<a class="sourceLine" id="cb353-46" data-line-number="46">       )</a>
<a class="sourceLine" id="cb353-47" data-line-number="47">     )</a>
<a class="sourceLine" id="cb353-48" data-line-number="48"></a>
<a class="sourceLine" id="cb353-49" data-line-number="49"><span class="co"># Label points with the textxy function from the calibrate package</span></a>
<a class="sourceLine" id="cb353-50" data-line-number="50"><span class="kw">library</span>(calibrate)</a>
<a class="sourceLine" id="cb353-51" data-line-number="51"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvalue<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAchol_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb353-52" data-line-number="52">     <span class="kw">textxy</span>(</a>
<a class="sourceLine" id="cb353-53" data-line-number="53">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb353-54" data-line-number="54">       <span class="op">-</span><span class="kw">log10</span>(pvalue),</a>
<a class="sourceLine" id="cb353-55" data-line-number="55">       <span class="dt">labs=</span>Gene,</a>
<a class="sourceLine" id="cb353-56" data-line-number="56">       <span class="dt">cex=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb353-57" data-line-number="57">       <span class="dt">family=</span><span class="st">&#39;Raleway&#39;</span></a>
<a class="sourceLine" id="cb353-58" data-line-number="58">       )</a>
<a class="sourceLine" id="cb353-59" data-line-number="59">     )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
</div>
<div id="ha-bortezomib-plot" class="section level6">
<h6>HA Bortezomib plot</h6>
<p>Bortezomib treatment alters the proteome.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" data-line-number="1"><span class="co"># bold axis titles</span></a>
<a class="sourceLine" id="cb354-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">font.lab=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb354-3" data-line-number="3"></a>
<a class="sourceLine" id="cb354-4" data-line-number="4"><span class="co"># create plot</span></a>
<a class="sourceLine" id="cb354-5" data-line-number="5"><span class="kw">with</span>(proteomics_data,</a>
<a class="sourceLine" id="cb354-6" data-line-number="6">     <span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb354-7" data-line-number="7">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb354-8" data-line-number="8">       <span class="op">-</span><span class="kw">log10</span>(pvaluebort),</a>
<a class="sourceLine" id="cb354-9" data-line-number="9">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb354-10" data-line-number="10">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb354-11" data-line-number="11">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),</a>
<a class="sourceLine" id="cb354-12" data-line-number="12">       <span class="dt">main=</span><span class="st">&#39;Nrf1 AP-MS volcano plot Bortezomib vs chow&#39;</span>,</a>
<a class="sourceLine" id="cb354-13" data-line-number="13">       <span class="dt">xlab=</span><span class="st">&#39;log2(FC HA bort/HA chow)&#39;</span>,</a>
<a class="sourceLine" id="cb354-14" data-line-number="14">       <span class="dt">ylab=</span><span class="st">&#39;-log10(pvalue HA bort vs HA chow)&#39;</span></a>
<a class="sourceLine" id="cb354-15" data-line-number="15">       )</a>
<a class="sourceLine" id="cb354-16" data-line-number="16">     )</a>
<a class="sourceLine" id="cb354-17" data-line-number="17"><span class="co"># Add colored points:</span></a>
<a class="sourceLine" id="cb354-18" data-line-number="18"><span class="co"># red if pvalue&lt;0.05, orange if log2FC&gt;1, green if both)</span></a>
<a class="sourceLine" id="cb354-19" data-line-number="19"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvaluebort<span class="op">&lt;</span>.<span class="dv">05</span> ),</a>
<a class="sourceLine" id="cb354-20" data-line-number="20">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb354-21" data-line-number="21">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb354-22" data-line-number="22">       <span class="op">-</span><span class="kw">log10</span>(pvaluebort),</a>
<a class="sourceLine" id="cb354-23" data-line-number="23">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb354-24" data-line-number="24">       <span class="dt">col=</span><span class="st">&#39;red&#39;</span></a>
<a class="sourceLine" id="cb354-25" data-line-number="25">       )</a>
<a class="sourceLine" id="cb354-26" data-line-number="26">     )</a>
<a class="sourceLine" id="cb354-27" data-line-number="27"></a>
<a class="sourceLine" id="cb354-28" data-line-number="28"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, <span class="kw">abs</span>(log2_FC_HAbort_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb354-29" data-line-number="29">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb354-30" data-line-number="30">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb354-31" data-line-number="31">       <span class="op">-</span><span class="kw">log10</span>(pvaluebort),</a>
<a class="sourceLine" id="cb354-32" data-line-number="32">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb354-33" data-line-number="33">       <span class="dt">col=</span><span class="st">&#39;orange&#39;</span></a>
<a class="sourceLine" id="cb354-34" data-line-number="34">       )</a>
<a class="sourceLine" id="cb354-35" data-line-number="35">     )</a>
<a class="sourceLine" id="cb354-36" data-line-number="36"></a>
<a class="sourceLine" id="cb354-37" data-line-number="37"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvaluebort<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAbort_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb354-38" data-line-number="38">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb354-39" data-line-number="39">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb354-40" data-line-number="40">       <span class="op">-</span><span class="kw">log10</span>(pvaluebort),</a>
<a class="sourceLine" id="cb354-41" data-line-number="41">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb354-42" data-line-number="42">       <span class="dt">col=</span><span class="st">&#39;green&#39;</span></a>
<a class="sourceLine" id="cb354-43" data-line-number="43">       )</a>
<a class="sourceLine" id="cb354-44" data-line-number="44">     )</a>
<a class="sourceLine" id="cb354-45" data-line-number="45"></a>
<a class="sourceLine" id="cb354-46" data-line-number="46"><span class="co"># Label points with the textxy function from the calibrate package</span></a>
<a class="sourceLine" id="cb354-47" data-line-number="47"><span class="kw">library</span>(calibrate)</a>
<a class="sourceLine" id="cb354-48" data-line-number="48"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvaluebort<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAbort_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb354-49" data-line-number="49">     <span class="kw">textxy</span>(</a>
<a class="sourceLine" id="cb354-50" data-line-number="50">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb354-51" data-line-number="51">       <span class="op">-</span><span class="kw">log10</span>(pvaluebort),</a>
<a class="sourceLine" id="cb354-52" data-line-number="52">       <span class="dt">labs=</span>Gene,</a>
<a class="sourceLine" id="cb354-53" data-line-number="53">       <span class="dt">cex=</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb354-54" data-line-number="54">       )</a>
<a class="sourceLine" id="cb354-55" data-line-number="55">     )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="ha-vs-lacz-plot" class="section level6">
<h6>HA vs lacZ plot</h6>
<p>The proteome was not significantly different with or without the HA tag, indicating issues with the HA immunoprecipitation. Note that the code for labeling points appears to be separated from the rest of the code for the plot, possibly because there were no points labeled.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" data-line-number="1"><span class="co"># bold axis titles</span></a>
<a class="sourceLine" id="cb355-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">font.lab=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb355-3" data-line-number="3"></a>
<a class="sourceLine" id="cb355-4" data-line-number="4"><span class="co"># create plot</span></a>
<a class="sourceLine" id="cb355-5" data-line-number="5"><span class="kw">with</span>(proteomics_data,</a>
<a class="sourceLine" id="cb355-6" data-line-number="6">     <span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb355-7" data-line-number="7">       log2_FC_HAchow_lacZ,</a>
<a class="sourceLine" id="cb355-8" data-line-number="8">       <span class="op">-</span><span class="kw">log10</span>(pvaluechow),</a>
<a class="sourceLine" id="cb355-9" data-line-number="9">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb355-10" data-line-number="10">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb355-11" data-line-number="11">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb355-12" data-line-number="12">       <span class="dt">yaxp=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb355-13" data-line-number="13">       <span class="dt">main=</span><span class="st">&#39;Nrf1 AP-MS volcano plot HA vs lacZ&#39;</span>,</a>
<a class="sourceLine" id="cb355-14" data-line-number="14">       <span class="dt">xlab=</span><span class="st">&#39;log2(FC HA chow/lacZ chow)&#39;</span>,</a>
<a class="sourceLine" id="cb355-15" data-line-number="15">       <span class="dt">ylab=</span><span class="st">&#39;-log10(pvalue HA chow vs lacZ chow)&#39;</span></a>
<a class="sourceLine" id="cb355-16" data-line-number="16">       )</a>
<a class="sourceLine" id="cb355-17" data-line-number="17">     )</a>
<a class="sourceLine" id="cb355-18" data-line-number="18"></a>
<a class="sourceLine" id="cb355-19" data-line-number="19"><span class="co"># Add colored points:</span></a>
<a class="sourceLine" id="cb355-20" data-line-number="20"><span class="co"># red if pvalue&lt;0.05, orange if [log2FC]&gt;1, green if both)</span></a>
<a class="sourceLine" id="cb355-21" data-line-number="21"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvaluechow<span class="op">&lt;</span>.<span class="dv">05</span>),</a>
<a class="sourceLine" id="cb355-22" data-line-number="22">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb355-23" data-line-number="23">       log2_FC_HAchow_lacZ,</a>
<a class="sourceLine" id="cb355-24" data-line-number="24">       <span class="op">-</span><span class="kw">log10</span>(pvaluechow),</a>
<a class="sourceLine" id="cb355-25" data-line-number="25">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb355-26" data-line-number="26">       <span class="dt">col=</span><span class="st">&#39;red&#39;</span></a>
<a class="sourceLine" id="cb355-27" data-line-number="27">       )</a>
<a class="sourceLine" id="cb355-28" data-line-number="28">     )</a>
<a class="sourceLine" id="cb355-29" data-line-number="29"></a>
<a class="sourceLine" id="cb355-30" data-line-number="30"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, <span class="kw">abs</span>(log2_FC_HAchow_lacZ)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb355-31" data-line-number="31">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb355-32" data-line-number="32">       log2_FC_HAchow_lacZ,</a>
<a class="sourceLine" id="cb355-33" data-line-number="33">       <span class="op">-</span><span class="kw">log10</span>(pvaluechow),</a>
<a class="sourceLine" id="cb355-34" data-line-number="34">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb355-35" data-line-number="35">       <span class="dt">col=</span><span class="st">&#39;orange&#39;</span></a>
<a class="sourceLine" id="cb355-36" data-line-number="36">       )</a>
<a class="sourceLine" id="cb355-37" data-line-number="37">     )</a>
<a class="sourceLine" id="cb355-38" data-line-number="38"></a>
<a class="sourceLine" id="cb355-39" data-line-number="39"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvaluechow<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAchow_lacZ)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb355-40" data-line-number="40">     <span class="kw">points</span>(</a>
<a class="sourceLine" id="cb355-41" data-line-number="41">       log2_FC_HAchow_lacZ,</a>
<a class="sourceLine" id="cb355-42" data-line-number="42">       <span class="op">-</span><span class="kw">log10</span>(pvaluechow),</a>
<a class="sourceLine" id="cb355-43" data-line-number="43">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb355-44" data-line-number="44">       <span class="dt">col=</span><span class="st">&#39;green&#39;</span></a>
<a class="sourceLine" id="cb355-45" data-line-number="45">       )</a>
<a class="sourceLine" id="cb355-46" data-line-number="46">     )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb356-1" data-line-number="1"><span class="co"># Label points with the textxy function from the calibrate package</span></a>
<a class="sourceLine" id="cb356-2" data-line-number="2"><span class="kw">library</span>(calibrate)</a>
<a class="sourceLine" id="cb356-3" data-line-number="3"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvaluechow<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAchow_lacZ)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb356-4" data-line-number="4">     <span class="kw">textxy</span>(</a>
<a class="sourceLine" id="cb356-5" data-line-number="5">       log2_FC_HAchow_lacZ,</a>
<a class="sourceLine" id="cb356-6" data-line-number="6">       <span class="op">-</span><span class="kw">log10</span>(pvaluechow),</a>
<a class="sourceLine" id="cb356-7" data-line-number="7">       <span class="dt">labs=</span>Gene,</a>
<a class="sourceLine" id="cb356-8" data-line-number="8">       <span class="dt">cex=</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb356-9" data-line-number="9">       )</a>
<a class="sourceLine" id="cb356-10" data-line-number="10">     )</a></code></pre></div>
</div>
<div id="scatter-plot" class="section level6">
<h6>Scatter plot</h6>
<p>The scatter plot is an interesting way to visualize two between-group comparisons, but the volcano plot is more useful for this dataset.</p>
<p>To set size of points according to p value:</p>
<pre><code>dotsize &lt;- -log10(pvalue)
head(dotsize)</code></pre>
<p>then put <code>cex=dotsize</code> inside the <code>plot()</code> and <code>points()</code> functions.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" data-line-number="1"><span class="co"># set size of points according to p value</span></a>
<a class="sourceLine" id="cb358-2" data-line-number="2">dotsize &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log10</span>(pvalue)</a>
<a class="sourceLine" id="cb358-3" data-line-number="3"></a>
<a class="sourceLine" id="cb358-4" data-line-number="4"><span class="co"># bold axis titles</span></a>
<a class="sourceLine" id="cb358-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">font.lab=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb358-6" data-line-number="6"></a>
<a class="sourceLine" id="cb358-7" data-line-number="7"><span class="co"># create plot</span></a>
<a class="sourceLine" id="cb358-8" data-line-number="8"><span class="kw">with</span>(proteomics_data,</a>
<a class="sourceLine" id="cb358-9" data-line-number="9">     <span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb358-10" data-line-number="10">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb358-11" data-line-number="11">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb358-12" data-line-number="12">       <span class="dt">pch=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb358-13" data-line-number="13">       <span class="dt">main=</span><span class="st">&#39;Nrf1 AP-MS scatter plot&#39;</span>,</a>
<a class="sourceLine" id="cb358-14" data-line-number="14">       <span class="dt">xlab=</span><span class="st">&#39;log2(FC HA chol/HA chow)&#39;</span>,</a>
<a class="sourceLine" id="cb358-15" data-line-number="15">       <span class="dt">ylab=</span><span class="st">&#39;log2(FC HA bort/HA chow)&#39;</span>,</a>
<a class="sourceLine" id="cb358-16" data-line-number="16">       <span class="dt">cex=</span>dotsize</a>
<a class="sourceLine" id="cb358-17" data-line-number="17">       )</a>
<a class="sourceLine" id="cb358-18" data-line-number="18">     )</a>
<a class="sourceLine" id="cb358-19" data-line-number="19"></a>
<a class="sourceLine" id="cb358-20" data-line-number="20"><span class="co"># Label points with the textxy function from the calibrate package</span></a>
<a class="sourceLine" id="cb358-21" data-line-number="21"><span class="kw">library</span>(calibrate)</a>
<a class="sourceLine" id="cb358-22" data-line-number="22"><span class="kw">with</span>(<span class="kw">subset</span>(proteomics_data, pvalue<span class="op">&lt;</span>.<span class="dv">05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(log2_FC_HAchol_HAchow)<span class="op">&gt;</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb358-23" data-line-number="23">     <span class="kw">textxy</span>(</a>
<a class="sourceLine" id="cb358-24" data-line-number="24">       log2_FC_HAchol_HAchow,</a>
<a class="sourceLine" id="cb358-25" data-line-number="25">       log2_FC_HAbort_HAchow,</a>
<a class="sourceLine" id="cb358-26" data-line-number="26">       <span class="dt">labs=</span>Gene</a>
<a class="sourceLine" id="cb358-27" data-line-number="27">       )</a>
<a class="sourceLine" id="cb358-28" data-line-number="28">     )</a></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
